(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{839:function(t,e,r){"use strict";r.r(e),function(t,n){r.d(e,"Field",(function(){return d})),r.d(e,"ScalarFill",(function(){return vr})),r.d(e,"WindLayer",(function(){return br}));r(55),r(56),r(219),r(57),r(235),r(37),r(52),r(150),r(108),r(74),r(236),r(11),r(159),r(73),r(148),r(237),r(238),r(239),r(220),r(240),r(110),r(221),r(75),r(222),r(223),r(160),r(241),r(111),r(149),r(242),r(154),r(114),r(107),r(112),r(5),r(226),r(227),r(54),r(109),r(38),r(224),r(72),r(225),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254),r(255),r(256),r(257),r(258),r(259),r(260),r(261),r(262),r(263),r(264),r(265),r(266),r(267),r(268),r(53),r(47),r(269),r(270);var i=r(1),o=r(826),a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};
/*!
 * author: sakitam-fdd <smilefdd@gmail.com> 
 * wind-core v1.0.0-alpha.7
 * build-time: 2020-6-21 15:56
 * LICENSE: MIT
 * (c) 2017-2020 https://github.com/sakitam-fdd/wind-layer#readme
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function s(){for(var t=arguments,e=0,r=0,n=arguments.length;r<n;r++)e+=t[r].length;var i=Array(e),o=0;for(r=0;r<n;r++)for(var a=arguments[r],s=0,u=a.length;s<u;s++,o++)i[o]=a[s];return i}Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){var r=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),i=1;i<arguments.length;i++){var o=r[i];if(null!=o)for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(n[a]=o[a])}return n},writable:!0,configurable:!0});var u=Object.prototype.hasOwnProperty,l="undefined"!=typeof Symbol?Symbol.toStringTag:void 0;function c(t){if(!function(t){var e=Object(i.a)(t);return null!==t&&("object"===e||"function"===e)}(t))return!1;var e=function(t){if(null===t)return void 0===t?"[object Undefined]":"[object Null]";if(!(l&&l in Object(t)))return toString.call(t);var e=u.call(t,l),r=t[l],n=!1;try{t[l]=void 0,n=!0}catch(t){}var i=Object.prototype.toString.call(t);return n&&(e?t[l]=r:delete t[l]),i}(t);return"[object Function]"===e||"[object AsyncFunction]"===e||"[object GeneratorFunction]"===e||"[object Proxy]"===e}function h(t){return"[object Number]"===Object.prototype.toString.call(t)&&!isNaN(t)}function g(t){for(var e=arguments,r=[],n=1;n<arguments.length;n++)r[n-1]=e[n];return Object.assign.apply(Object,s([t],r))}function p(t){return null!=t&&!isNaN(t)}var f=function(){function t(t,e){this.u=t,this.v=e,this.m=this.magnitude()}return t.prototype.magnitude=function(){return Math.sqrt(this.u*this.u+this.v*this.v)},t.prototype.directionTo=function(){var t=Math.atan2(this.u,this.v)*(180/Math.PI);return t<0&&(t+=360),t},t.prototype.directionFrom=function(){return(this.directionTo()+180)%360},t}(),d=function(){function t(t){this.grid=[],this.xmin=t.xmin,this.xmax=t.xmax,this.ymin=Math.min(t.ymax,t.ymin),this.ymax=Math.max(t.ymax,t.ymin),this.cols=t.cols,this.rows=t.rows,this.us=t.us,this.vs=t.vs,this.deltaX=t.deltaX,this.deltaY=t.deltaY,this.isFields=!0;var e=Math.ceil((this.xmax-this.xmin)/t.deltaX),r=Math.ceil((this.ymax-this.ymin)/t.deltaY);e===this.cols&&r===this.rows||console.warn("The data grid not equal"),this.isContinuous=Math.floor(this.cols*t.deltaX)>=360,this.wrappedX="wrappedX"in t?t.wrappedX:this.xmax>180,this.grid=this.buildGrid(),this.range=this.calculateRange()}return t.prototype.buildGrid=function(){for(var t=[],e=0,r=this.rows,n=this.cols,i=this.us,o=this.vs,a=0;a<r;a++){for(var s=[],u=0;u<n;u++,e++){var l=i[e],c=o[e],h=this.isValid(l)&&this.isValid(c);s[u]=h?new f(l,c):null}this.isContinuous&&s.push(s[0]),t[a]=s}return t},t.prototype.release=function(){this.grid=[],this.columns=[]},t.prototype.extent=function(){return[this.xmin,this.ymin,this.xmax,this.ymax]},t.prototype.bilinearInterpolateVector=function(t,e,r,n,i,o){var a=1-t,s=1-e,u=a*s,l=t*s,c=a*e,h=t*e,g=r.u*u+n.u*l+i.u*c+o.u*h,p=r.v*u+n.v*l+i.v*c+o.v*h;return new f(g,p)},t.prototype.calculateRange=function(){if(this.grid&&this.grid[0]){for(var t,e,r=this.grid.length,n=this.grid[0].length,i=0;i<r;i++)for(var o=0;o<n;o++){var a=this.grid[i][o];if(null!==a){var s=a.m||a.magnitude();void 0===t?t=s:void 0===e?(e=s,t=Math.min(t,e),e=Math.max(t,e)):(t=Math.min(s,t),e=Math.max(s,e))}}return[t,e]}},t.prototype.isValid=function(t){return null!=t},t.prototype.getWrappedLongitudes=function(){var t=this.xmin,e=this.xmax;return this.wrappedX&&(this.isContinuous?(t=-180,e=180):(e=this.xmax-360,t=this.xmin-360)),[t,e]},t.prototype.contains=function(t,e){var r=this.getWrappedLongitudes(),n=r[0],i=r[1],o=t>=n&&t<=i,a=e>=this.ymin&&e<=this.ymax;return o&&a},t.prototype.getDecimalIndexes=function(t,e){var r,n;return[((r=t-this.xmin)-(n=360)*Math.floor(r/n))/this.deltaX,(this.ymax-e)/this.deltaY]},t.prototype.valueAt=function(t,e){if(!this.contains(t,e))return null;var r=this.getDecimalIndexes(t,e),n=Math.floor(r[0]),i=Math.floor(r[1]),o=this.clampColumnIndex(n),a=this.clampRowIndex(i);return this.valueAtIndexes(o,a)},t.prototype.interpolatedValueAt=function(t,e){if(!this.contains(t,e))return null;var r=this.getDecimalIndexes(t,e),n=r[0],i=r[1];return this.interpolatePoint(n,i)},t.prototype.hasValueAt=function(t,e){return null!==this.valueAt(t,e)},t.prototype.interpolatePoint=function(t,e){var r=this.getFourSurroundingIndexes(t,e),n=r[0],i=r[1],o=r[2],a=r[3],s=this.getFourSurroundingValues(n,i,o,a);if(s){var u=s[0],l=s[1],c=s[2],h=s[3];return this.bilinearInterpolateVector(t-n,e-o,u,l,c,h)}return null},t.prototype.clampColumnIndex=function(t){var e=t;t<0&&(e=0);var r=this.cols-1;return t>r&&(e=r),e},t.prototype.clampRowIndex=function(t){var e=t;t<0&&(e=0);var r=this.rows-1;return t>r&&(e=r),e},t.prototype.getFourSurroundingIndexes=function(t,e){var r=Math.floor(t),n=r+1;this.isContinuous&&n>=this.cols&&(n=0),n=this.clampColumnIndex(n);var i=this.clampRowIndex(Math.floor(e));return[r,n,i,this.clampRowIndex(i+1)]},t.prototype.getFourSurroundingValues=function(t,e,r,n){var i;if(i=this.grid[r]){var o=i[t],a=i[e];if(this.isValid(o)&&this.isValid(a)&&(i=this.grid[n])){var s=i[t],u=i[e];if(this.isValid(s)&&this.isValid(u))return[o,a,s,u]}}return null},t.prototype.valueAtIndexes=function(t,e){return this.grid[e][t]},t.prototype.lonLatAtIndexes=function(t,e){return[this.longitudeAtX(t),this.latitudeAtY(e)]},t.prototype.longitudeAtX=function(t){var e=this.deltaX/2,r=this.xmin+e+t*this.deltaX;return this.wrappedX&&(r=r>180?r-360:r),r},t.prototype.latitudeAtY=function(t){var e=this.deltaY/2;return this.ymax-e-t*this.deltaY},t.prototype.randomize=function(t,e,r,n){void 0===t&&(t={});var i=Math.random()*(e||this.cols)|0,o=Math.random()*(r||this.rows)|0,a=n([i,o]);return null!==a?(t.x=a[0],t.y=a[1]):(t.x=this.longitudeAtX(i),t.y=this.latitudeAtY(o)),t},t.prototype.checkFields=function(){return this.isFields},t.prototype.startBatchInterpolate=function(t,e,r){},t}(),y={globalAlpha:.9,lineWidth:1,colorScale:"#fff",velocityScale:.04,maxAge:90,paths:800,frameRate:20,useCoordsDraw:!0,gpet:!0};function I(t,e,r,n){return Math.max(0,Math.min(n.length-1,Math.round((t-e)/(r-e)*(n.length-1))))}var B=function(){function t(t,e,r){if(this.generated=!1,this.ctx=t,!this.ctx)throw new Error("ctx error");this.animate=this.animate.bind(this),this.setOptions(e),r&&this.updateData(r)}return t.prototype.setOptions=function(t){this.options=Object.assign({},y,t);var e=this.ctx.canvas,r=e.width,n=e.height;"particleAge"in t&&!("maxAge"in t)&&h(this.options.particleAge)&&(this.options.maxAge=this.options.particleAge),"particleMultiplier"in t&&!("paths"in t)&&h(this.options.particleMultiplier)&&(this.options.paths=Math.round(r*n*this.options.particleMultiplier)),this.prerender()},t.prototype.getOptions=function(){return this.options},t.prototype.updateData=function(t){this.field=t},t.prototype.moveParticles=function(){for(var t=this.ctx.canvas,e=t.width,r=t.height,n=this.particles,i=this.options.maxAge,o=c(this.options.velocityScale)?this.options.velocityScale():this.options.velocityScale,a=0,s=n.length;a<s;a++){var u=n[a];u.age>i&&(u.age=0,this.field.randomize(u,e,r,this.unproject));var l=u.x,h=u.y,g=this.field.interpolatedValueAt(l,h);if(null===g)u.age=i;else{var p=l+g.u*o,f=h+g.v*o;this.field.hasValueAt(p,f)?(u.xt=p,u.yt=f,u.m=g.m):(u.x=p,u.y=f,u.age=i)}u.age++}},t.prototype.fadeIn=function(){var t=this.ctx.globalCompositeOperation;this.ctx.globalCompositeOperation="destination-in",this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.globalCompositeOperation=t},t.prototype.drawParticles=function(){var t,e,r=this.particles;this.fadeIn(),this.ctx.globalAlpha=this.options.globalAlpha,this.ctx.fillStyle="rgba(0, 0, 0, "+this.options.globalAlpha+")",this.ctx.lineWidth=h(this.options.lineWidth)?this.options.lineWidth:1,this.ctx.strokeStyle=null!=(e=this.options.colorScale)&&("string"==typeof e||null!==e.constructor&&e.constructor===String)?this.options.colorScale:"#fff";var n=0,i=r.length;if(this.field&&i>0){var o=void 0,a=void 0;for(p(this.options.minVelocity)&&p(this.options.maxVelocity)?(o=this.options.minVelocity,a=this.options.maxVelocity):(o=(t=this.field.range)[0],a=t[1]);n<i;n++)this[this.options.useCoordsDraw?"drawCoordsParticle":"drawPixelParticle"](r[n],o,a)}},t.prototype.drawPixelParticle=function(t,e,r){var n=[t.x,t.y],i=[t.xt,t.yt];if(i&&n&&p(i[0])&&p(i[1])&&p(n[0])&&p(n[1])&&t.age<=this.options.maxAge){if(this.ctx.beginPath(),this.ctx.moveTo(n[0],n[1]),this.ctx.lineTo(i[0],i[1]),c(this.options.colorScale))this.ctx.strokeStyle=this.options.colorScale(t.m);else if(Array.isArray(this.options.colorScale)){var o=I(t.m,e,r,this.options.colorScale);this.ctx.strokeStyle=this.options.colorScale[o]}c(this.options.lineWidth)&&(this.ctx.lineWidth=this.options.lineWidth(t.m)),t.x=t.xt,t.y=t.yt,this.ctx.stroke()}},t.prototype.drawCoordsParticle=function(t,e,r){var n=[t.x,t.y],i=[t.xt,t.yt];if(i&&n&&p(i[0])&&p(i[1])&&p(n[0])&&p(n[1])&&this.intersectsCoordinate(i)&&t.age<=this.options.maxAge){var o=this.project(n),a=this.project(i);if(o&&a){if(this.ctx.beginPath(),this.ctx.moveTo(o[0],o[1]),this.ctx.lineTo(a[0],a[1]),t.x=t.xt,t.y=t.yt,c(this.options.colorScale))this.ctx.strokeStyle=this.options.colorScale(t.m);else if(Array.isArray(this.options.colorScale)){var s=I(t.m,e,r,this.options.colorScale);this.ctx.strokeStyle=this.options.colorScale[s]}c(this.options.lineWidth)&&(this.ctx.lineWidth=this.options.lineWidth(t.m)),this.ctx.stroke()}}},t.prototype.prepareParticlePaths=function(){var t=this.ctx.canvas,e=t.width,r=t.height,n="function"==typeof this.options.paths?this.options.paths(this):this.options.paths,i=[];if(!this.field)return[];"startBatchInterpolate"in this.field&&this.field.startBatchInterpolate(e,r,this.unproject);for(var o=0;o<n;o++)i.push(this.field.randomize({age:this.randomize()},e,r,this.unproject));return i},t.prototype.randomize=function(){return Math.floor(Math.random()*this.options.maxAge)},t.prototype.project=function(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];throw new Error("project must be overriden")},t.prototype.unproject=function(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];throw new Error("unproject must be overriden")},t.prototype.intersectsCoordinate=function(t){throw new Error("must be overriden")},t.prototype.clearCanvas=function(){this.stop(),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.forceStop=!1},t.prototype.start=function(){this.starting=!0,this.forceStop=!1,this._then=Date.now(),this.animate()},t.prototype.stop=function(){cancelAnimationFrame(this.animationLoop),this.starting=!1,this.forceStop=!0},t.prototype.animate=function(){this.animationLoop&&cancelAnimationFrame(this.animationLoop),this.animationLoop=requestAnimationFrame(this.animate);var t=Date.now(),e=t-this._then;e>this.options.frameRate&&(this._then=t-e%this.options.frameRate,this.render())},t.prototype.prerender=function(){this.generated=!1,this.particles=this.prepareParticlePaths(),this.generated=!0,this.starting||this.forceStop||(this.starting=!0,this._then=Date.now(),this.animate())},t.prototype.render=function(){this.moveParticles(),this.drawParticles(),this.postrender()},t.prototype.postrender=function(){},t.Field=d,t}();function m(t){return t?(t.parentNode&&t.parentNode.removeChild(t),t):null}var v=function(){function t(t,e){if(void 0===e&&(e={}),!t)throw Error("layer id must be specified");this.id=t,this.options=e,this.canvas=null,this.canvas2=null,this.devicePixelRatio=this.options.devicePixelRatio||window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI,this.render=this.render.bind(this),this.type="custom",this.renderingMode="2d"}return t.prototype.onAdd=function(t){this.setMap(t),this.canvas=this.initialize(),this.canvas2=this.initialize()},t.prototype.initialize=function(){var t=this.map.getCanvasContainer(),e=this.map.getCanvas(),r=document.createElement("canvas"),n=this.map.transform,i=n.width,o=n.height,a=this.devicePixelRatio;return r.width=i*a,r.height=o*a,r.style.position="absolute",r.className="mapbox-overlay-canvas",r.style.width=e.style.width,r.style.height=e.style.height,t.appendChild(r),r},t.prototype.render=function(){},t.prototype.project=function(t){if(void 0!==this.map){var e=this.map.project(new o.LngLat(t[0],t[1])),r=e.x,n=e.y;return[r*this.devicePixelRatio,n*this.devicePixelRatio]}return t},t.prototype.unproject=function(t){if(void 0!==this.map){var e=this.map.unproject(new o.Point(t[0],t[1]));return[e.lng,e.lat]}return t},t.prototype.intersectsCoordinate=function(t){return this.map.getBounds().contains(new o.LngLat(t[0],t[1]))},t.prototype.clear=function(){var t;this.canvas&&((t=this.canvas.getContext("2d"))&&t.clearRect(0,0,this.canvas.width,this.canvas.height));this.canvas2&&((t=this.canvas2.getContext("2d"))&&t.clearRect(0,0,this.canvas2.width,this.canvas2.height))},t.prototype.setMap=function(t){return this.map=t,this},t.prototype.getMap=function(){return this.map},t.prototype.addTo=function(t){this.onAdd(t)},t.prototype.remove=function(){this.canvas&&(m(this.canvas),this.canvas=null),this.canvas2&&(m(this.canvas2),this.canvas2=null)},t}(),F=function(t,e){return(F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};
/*!
 * author: sakitam-fdd <smilefdd@gmail.com> 
 * wind-gl-core v1.0.0-alpha.8
 * build-time: 2020-6-21 18:29
 * LICENSE: MIT
 * (c) 2017-2020 https://github.com/sakitam-fdd/wind-layer#readme
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function b(t,e){function r(){this.constructor=t}F(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function Q(){for(var t=arguments,e=0,r=0,n=arguments.length;r<n;r++)e+=t[r].length;var i=Array(e),o=0;for(r=0;r<n;r++)for(var a=arguments[r],s=0,u=a.length;s<u;s++,o++)i[o]=a[s];return i}var U="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function C(t,e){return t(e={exports:{}},e.exports),e.exports}C((function(t,e){!function(r){var n=e&&!e.nodeType&&e,o=t&&!t.nodeType&&t,a="object"==Object(i.a)(U)&&U;a.global!==a&&a.window!==a&&a.self!==a||(r=a);var s,u,l=2147483647,c=/^xn--/,h=/[^\x20-\x7E]/,g=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,d=String.fromCharCode;function y(t){throw RangeError(p[t])}function I(t,e){for(var r=t.length,n=[];r--;)n[r]=e(t[r]);return n}function B(t,e){var r=t.split("@"),n="";return r.length>1&&(n=r[0]+"@",t=r[1]),n+I((t=t.replace(g,".")).split("."),e).join(".")}function m(t){for(var e,r,n=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(r=t.charCodeAt(i++)))?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),i--):n.push(e);return n}function v(t){return I(t,(function(t){var e="";return t>65535&&(e+=d((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=d(t)})).join("")}function F(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function b(t,e,r){var n=0;for(t=r?f(t/700):t>>1,t+=f(t/e);t>455;n+=36)t=f(t/35);return f(n+36*t/(t+38))}function Q(t){var e,r,n,i,o,a,s,u,c,h,g,p=[],d=t.length,I=0,B=128,m=72;for((r=t.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)t.charCodeAt(n)>=128&&y("not-basic"),p.push(t.charCodeAt(n));for(i=r>0?r+1:0;i<d;){for(o=I,a=1,s=36;i>=d&&y("invalid-input"),((u=(g=t.charCodeAt(i++))-48<10?g-22:g-65<26?g-65:g-97<26?g-97:36)>=36||u>f((l-I)/a))&&y("overflow"),I+=u*a,!(u<(c=s<=m?1:s>=m+26?26:s-m));s+=36)a>f(l/(h=36-c))&&y("overflow"),a*=h;m=b(I-o,e=p.length+1,0==o),f(I/e)>l-B&&y("overflow"),B+=f(I/e),I%=e,p.splice(I++,0,B)}return v(p)}function C(t){var e,r,n,i,o,a,s,u,c,h,g,p,I,B,v,Q=[];for(p=(t=m(t)).length,e=128,r=0,o=72,a=0;a<p;++a)(g=t[a])<128&&Q.push(d(g));for(n=i=Q.length,i&&Q.push("-");n<p;){for(s=l,a=0;a<p;++a)(g=t[a])>=e&&g<s&&(s=g);for(s-e>f((l-r)/(I=n+1))&&y("overflow"),r+=(s-e)*I,e=s,a=0;a<p;++a)if((g=t[a])<e&&++r>l&&y("overflow"),g==e){for(u=r,c=36;!(u<(h=c<=o?1:c>=o+26?26:c-o));c+=36)v=u-h,B=36-h,Q.push(d(F(h+v%B,0))),u=f(v/B);Q.push(d(F(u,0))),o=b(r,I,n==i),r=0,++n}++r,++e}return Q.join("")}if(s={version:"1.3.2",ucs2:{decode:m,encode:v},decode:Q,encode:C,toASCII:function(t){return B(t,(function(t){return h.test(t)?"xn--"+C(t):t}))},toUnicode:function(t){return B(t,(function(t){return c.test(t)?Q(t.slice(4).toLowerCase()):t}))}},n&&o)if(t.exports==n)o.exports=s;else for(u in s)s.hasOwnProperty(u)&&(n[u]=s[u]);else r.punycode=s}(U)}));function x(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var A=function(t,e,r,n){e=e||"&",r=r||"=";var i={};if("string"!=typeof t||0===t.length)return i;var o=/\+/g;t=t.split(e);var a=1e3;n&&"number"==typeof n.maxKeys&&(a=n.maxKeys);var s=t.length;a>0&&s>a&&(s=a);for(var u=0;u<s;++u){var l,c,h,g,p=t[u].replace(o,"%20"),f=p.indexOf(r);f>=0?(l=p.substr(0,f),c=p.substr(f+1)):(l=p,c=""),h=decodeURIComponent(l),g=decodeURIComponent(c),x(i,h)?Array.isArray(i[h])?i[h].push(g):i[h]=[i[h],g]:i[h]=g}return i},S=function(t){switch(Object(i.a)(t)){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}},L=function(t,e,r,n){return e=e||"&",r=r||"=",null===t&&(t=void 0),"object"===Object(i.a)(t)?Object.keys(t).map((function(n){var i=encodeURIComponent(S(n))+r;return Array.isArray(t[n])?t[n].map((function(t){return i+encodeURIComponent(S(t))})).join(e):i+encodeURIComponent(S(t[n]))})).join(e):n?encodeURIComponent(S(n))+r+encodeURIComponent(S(t)):""},E=C((function(t,e){e.decode=e.parse=A,e.encode=e.stringify=L}));E.decode,E.parse,E.encode,E.stringify;function w(t){for(var e=arguments,r=[],n=arguments.length-1;n-- >0;)r[n]=e[n+1];for(var i=0,o=r;i<o.length;i+=1){var a=o[i];for(var s in a)t[s]=a[s]}return t}var G=function(t){function e(e,r){t.call(this,r),this.message=r,this.key=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),X=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var r=0,n=e;r<n.length;r+=1){var i=n[r],o=i[0],a=i[1];this.bindings[o]=a}};X.prototype.concat=function(t){return new X(this,t)},X.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},X.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var D={kind:"null"},R={kind:"number"},Z={kind:"string"},V={kind:"boolean"},H={kind:"color"},k={kind:"object"},N={kind:"value"},W={kind:"collator"},M={kind:"formatted"},J={kind:"resolvedImage"};function Y(t,e){return{kind:"array",itemType:t,N:e}}function T(t){if("array"===t.kind){var e=T(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var K=[D,R,Z,V,H,M,k,Y(N),J];function _(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!_(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var r=0,n=K;r<n.length;r+=1){if(!_(n[r],e))return null}}return"Expected "+T(t)+" but found "+T(e)+" instead."}function z(t,e){return e.some((function(e){return e.kind===t.kind}))}function O(t,e){return e.some((function(e){return"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"===Object(i.a)(t):e===Object(i.a)(t)}))}var j=C((function(t,e){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(t){return(t=Math.round(t))<0?0:t>255?255:t}function i(t){return t<0?0:t>1?1:t}function o(t){return"%"===t[t.length-1]?n(parseFloat(t)/100*255):n(parseInt(t))}function a(t){return"%"===t[t.length-1]?i(parseFloat(t)/100):i(parseFloat(t))}function s(t,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}try{e.parseCSSColor=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in r)return r[i].slice();if("#"===i[0])return 4===i.length?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===i.length&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var u=i.indexOf("("),l=i.indexOf(")");if(-1!==u&&l+1===i.length){var c=i.substr(0,u),h=i.substr(u+1,l-(u+1)).split(","),g=1;switch(c){case"rgba":if(4!==h.length)return null;g=a(h.pop());case"rgb":return 3!==h.length?null:[o(h[0]),o(h[1]),o(h[2]),g];case"hsla":if(4!==h.length)return null;g=a(h.pop());case"hsl":if(3!==h.length)return null;var p=(parseFloat(h[0])%360+360)%360/360,f=a(h[1]),d=a(h[2]),y=d<=.5?d*(f+1):d+f-d*f,I=2*d-y;return[n(255*s(I,y,p+1/3)),n(255*s(I,y,p)),n(255*s(I,y,p-1/3)),g];default:return null}}return null}}catch(t){}})).parseCSSColor,P=function(t,e,r,n){void 0===n&&(n=1),this.r=t,this.g=e,this.b=r,this.a=n};P.parse=function(t){if(t){if(t instanceof P)return t;if("string"==typeof t){var e=j(t);if(e)return new P(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},P.prototype.toString=function(){var t=this.toArray(),e=t[0],r=t[1],n=t[2],i=t[3];return"rgba("+Math.round(e)+","+Math.round(r)+","+Math.round(n)+","+i+")"},P.prototype.toArray=function(){var t=this.r,e=this.g,r=this.b,n=this.a;return 0===n?[0,0,0,0]:[255*t/n,255*e/n,255*r/n,n]},P.black=new P(0,0,0,1),P.white=new P(1,1,1,1),P.transparent=new P(0,0,0,0),P.red=new P(1,0,0,1);var q=function(t,e,r){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};q.prototype.compare=function(t,e){return this.collator.compare(t,e)},q.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var $=function(t,e,r,n,i){this.text=t,this.image=e,this.scale=r,this.fontStack=n,this.textColor=i},tt=function(t){this.sections=t};tt.fromString=function(t){return new tt([new $(t,null,null,null,null)])},tt.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some((function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length}))},tt.factory=function(t){return t instanceof tt?t:tt.fromString(t)},tt.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map((function(t){return t.text})).join("")},tt.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var n=r[e];if(n.image)t.push(["image",n.image.name]);else{t.push(n.text);var i={};n.fontStack&&(i["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(i["font-scale"]=n.scale),n.textColor&&(i["text-color"]=["rgba"].concat(n.textColor.toArray())),t.push(i)}}return t};var et=function(t){this.name=t.name,this.available=t.available};function rt(t,e,r,n){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:"Invalid rgba value ["+[t,e,r,n].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof n?[t,e,r,n]:[t,e,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function nt(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof P)return!0;if(t instanceof q)return!0;if(t instanceof tt)return!0;if(t instanceof et)return!0;if(Array.isArray(t)){for(var e=0,r=t;e<r.length;e+=1){if(!nt(r[e]))return!1}return!0}if("object"===Object(i.a)(t)){for(var n in t)if(!nt(t[n]))return!1;return!0}return!1}function it(t){if(null===t)return D;if("string"==typeof t)return Z;if("boolean"==typeof t)return V;if("number"==typeof t)return R;if(t instanceof P)return H;if(t instanceof q)return W;if(t instanceof tt)return M;if(t instanceof et)return J;if(Array.isArray(t)){for(var e,r=t.length,n=0,i=t;n<i.length;n+=1){var o=it(i[n]);if(e){if(e===o)continue;e=N;break}e=o}return Y(e||N,r)}return k}function ot(t){var e=Object(i.a)(t);return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof P||t instanceof tt||t instanceof et?t.toString():JSON.stringify(t)}et.prototype.toString=function(){return this.name},et.fromString=function(t){return t?new et({name:t,available:!1}):null},et.prototype.serialize=function(){return["image",this.name]};var at=function(t,e){this.type=t,this.value=e};at.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!nt(t[1]))return e.error("invalid value");var r=t[1],n=it(r),i=e.expectedType;return"array"!==n.kind||0!==n.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(n=i),new at(n,r)},at.prototype.evaluate=function(){return this.value},at.prototype.eachChild=function(){},at.prototype.outputDefined=function(){return!0},at.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof P?["rgba"].concat(this.value.toArray()):this.value instanceof tt?this.value.serialize():this.value};var st=function(t){this.name="ExpressionEvaluationError",this.message=t};st.prototype.toJSON=function(){return this.message};var ut={string:Z,number:R,boolean:V,object:k},lt=function(t,e){this.type=t,this.args=e};lt.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r,n=1,i=t[0];if("array"===i){var o,a;if(t.length>2){var s=t[1];if("string"!=typeof s||!(s in ut)||"object"===s)return e.error('The item type argument of "array" must be one of string, number, boolean',1);o=ut[s],n++}else o=N;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],n++}r=Y(o,a)}else r=ut[i];for(var u=[];n<t.length;n++){var l=e.parse(t[n],n,N);if(!l)return null;u.push(l)}return new lt(r,u)},lt.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var r=this.args[e].evaluate(t);if(!_(this.type,it(r)))return r;if(e===this.args.length-1)throw new st("Expected value to be of type "+T(this.type)+", but found "+T(it(r))+" instead.")}return null},lt.prototype.eachChild=function(t){this.args.forEach(t)},lt.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},lt.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var r=t.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){e.push(r.kind);var n=t.N;("number"==typeof n||this.args.length>1)&&e.push(n)}}return e.concat(this.args.map((function(t){return t.serialize()})))};var ct=function(t){this.type=M,this.sections=t};ct.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r=t[1];if(!Array.isArray(r)&&"object"===Object(i.a)(r))return e.error("First argument must be an image or text section.");for(var n=[],o=!1,a=1;a<=t.length-1;++a){var s=t[a];if(o&&"object"===Object(i.a)(s)&&!Array.isArray(s)){o=!1;var u=null;if(s["font-scale"]&&!(u=e.parse(s["font-scale"],1,R)))return null;var l=null;if(s["text-font"]&&!(l=e.parse(s["text-font"],1,Y(Z))))return null;var c=null;if(s["text-color"]&&!(c=e.parse(s["text-color"],1,H)))return null;var h=n[n.length-1];h.scale=u,h.font=l,h.textColor=c}else{var g=e.parse(t[a],1,N);if(!g)return null;var p=g.type.kind;if("string"!==p&&"value"!==p&&"null"!==p&&"resolvedImage"!==p)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");o=!0,n.push({content:g,scale:null,font:null,textColor:null})}}return new ct(n)},ct.prototype.evaluate=function(t){return new tt(this.sections.map((function(e){var r=e.content.evaluate(t);return it(r)===J?new $("",r,null,null,null):new $(ot(r),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))},ct.prototype.eachChild=function(t){for(var e=0,r=this.sections;e<r.length;e+=1){var n=r[e];t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor)}},ct.prototype.outputDefined=function(){return!1},ct.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var n=r[e];t.push(n.content.serialize());var i={};n.scale&&(i["font-scale"]=n.scale.serialize()),n.font&&(i["text-font"]=n.font.serialize()),n.textColor&&(i["text-color"]=n.textColor.serialize()),t.push(i)}return t};var ht=function(t){this.type=J,this.input=t};ht.parse=function(t,e){if(2!==t.length)return e.error("Expected two arguments.");var r=e.parse(t[1],1,Z);return r?new ht(r):e.error("No image name provided.")},ht.prototype.evaluate=function(t){var e=this.input.evaluate(t),r=et.fromString(e);return r&&t.availableImages&&(r.available=t.availableImages.indexOf(e)>-1),r},ht.prototype.eachChild=function(t){t(this.input)},ht.prototype.outputDefined=function(){return!1},ht.prototype.serialize=function(){return["image",this.input.serialize()]};var gt={"to-boolean":V,"to-color":H,"to-number":R,"to-string":Z},pt=function(t,e){this.type=t,this.args=e};pt.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r=t[0];if(("to-boolean"===r||"to-string"===r)&&2!==t.length)return e.error("Expected one argument.");for(var n=gt[r],i=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,N);if(!a)return null;i.push(a)}return new pt(n,i)},pt.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,r,n=0,i=this.args;n<i.length;n+=1){if(r=null,(e=i[n].evaluate(t))instanceof P)return e;if("string"==typeof e){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(r=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":rt(e[0],e[1],e[2],e[3])))return new P(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new st(r||"Could not parse color from value '"+("string"==typeof e?e:String(JSON.stringify(e)))+"'")}if("number"===this.type.kind){for(var a=null,s=0,u=this.args;s<u.length;s+=1){if(null===(a=u[s].evaluate(t)))return 0;var l=Number(a);if(!isNaN(l))return l}throw new st("Could not convert "+JSON.stringify(a)+" to number.")}return"formatted"===this.type.kind?tt.fromString(ot(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?et.fromString(ot(this.args[0].evaluate(t))):ot(this.args[0].evaluate(t))},pt.prototype.eachChild=function(t){this.args.forEach(t)},pt.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},pt.prototype.serialize=function(){if("formatted"===this.type.kind)return new ct([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new ht(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild((function(e){t.push(e.serialize())})),t};var ft=["Unknown","Point","LineString","Polygon"],dt=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};dt.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},dt.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?ft[this.feature.type]:this.feature.type:null},dt.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},dt.prototype.canonicalID=function(){return this.canonical},dt.prototype.properties=function(){return this.feature&&this.feature.properties||{}},dt.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=P.parse(t)),e};var yt=function(t,e,r,n){this.name=t,this.type=e,this._evaluate=r,this.args=n};yt.prototype.evaluate=function(t){return this._evaluate(t,this.args)},yt.prototype.eachChild=function(t){this.args.forEach(t)},yt.prototype.outputDefined=function(){return!1},yt.prototype.serialize=function(){return[this.name].concat(this.args.map((function(t){return t.serialize()})))},yt.parse=function(t,e){var r,n=t[0],i=yt.definitions[n];if(!i)return e.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(i)?i[0]:i.type,a=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=a.filter((function(e){var r=e[0];return!Array.isArray(r)||r.length===t.length-1})),u=null,l=0,c=s;l<c.length;l+=1){var h=c[l],g=h[0],p=h[1];u=new Ht(e.registry,e.path,null,e.scope);for(var f=[],d=!1,y=1;y<t.length;y++){var I=t[y],B=Array.isArray(g)?g[y-1]:g.type,m=u.parse(I,1+f.length,B);if(!m){d=!0;break}f.push(m)}if(!d)if(Array.isArray(g)&&g.length!==f.length)u.error("Expected "+g.length+" arguments, but found "+f.length+" instead.");else{for(var v=0;v<f.length;v++){var F=Array.isArray(g)?g[v]:g.type,b=f[v];u.concat(v+1).checkSubtype(F,b.type)}if(0===u.errors.length)return new yt(n,o,p,f)}}if(1===s.length)(r=e.errors).push.apply(r,u.errors);else{for(var Q=(s.length?s:a).map((function(t){var e,r=t[0];return e=r,Array.isArray(e)?"("+e.map(T).join(", ")+")":"("+T(e.type)+"...)"})).join(" | "),U=[],C=1;C<t.length;C++){var x=e.parse(t[C],1+U.length);if(!x)return null;U.push(T(x.type))}e.error("Expected arguments of type "+Q+", but found ("+U.join(", ")+") instead.")}return null},yt.register=function(t,e){for(var r in yt.definitions=e,e)t[r]=yt};var It=function(t,e,r){this.type=W,this.locale=r,this.caseSensitive=t,this.diacriticSensitive=e};It.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var r=t[1];if("object"!==Object(i.a)(r)||Array.isArray(r))return e.error("Collator options argument must be an object.");var n=e.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,V);if(!n)return null;var o=e.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,V);if(!o)return null;var a=null;return r.locale&&!(a=e.parse(r.locale,1,Z))?null:new It(n,o,a)},It.prototype.evaluate=function(t){return new q(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},It.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},It.prototype.outputDefined=function(){return!1},It.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};function Bt(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function mt(t,e){return!(t[0]<=e[0])&&(!(t[2]>=e[2])&&(!(t[1]<=e[1])&&!(t[3]>=e[3])))}function vt(t,e){var r,n=(180+t[0])/360,i=(r=t[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360),o=Math.pow(2,e.z);return[Math.round(n*o*8192),Math.round(i*o*8192)]}function Ft(t,e,r){return e[1]>t[1]!=r[1]>t[1]&&t[0]<(r[0]-e[0])*(t[1]-e[1])/(r[1]-e[1])+e[0]}function bt(t,e){for(var r,n,i,o,a,s,u,l=!1,c=0,h=e.length;c<h;c++)for(var g=e[c],p=0,f=g.length;p<f-1;p++){if(r=t,n=g[p],i=g[p+1],o=void 0,a=void 0,s=void 0,u=void 0,o=r[0]-n[0],a=r[1]-n[1],s=r[0]-i[0],u=r[1]-i[1],o*u-s*a==0&&o*s<=0&&a*u<=0)return!1;Ft(t,g[p],g[p+1])&&(l=!l)}return l}function Qt(t,e){for(var r=0;r<e.length;r++)if(bt(t,e[r]))return!0;return!1}function Ut(t,e,r,n){var i=t[0]-r[0],o=t[1]-r[1],a=e[0]-r[0],s=e[1]-r[1],u=n[0]-r[0],l=n[1]-r[1],c=i*l-u*o,h=a*l-u*s;return c>0&&h<0||c<0&&h>0}function Ct(t,e,r){for(var n=0,i=r;n<i.length;n+=1)for(var o=i[n],a=0;a<o.length-1;++a)if(s=t,u=e,l=o[a],c=o[a+1],h=void 0,g=void 0,p=void 0,f=void 0,p=[u[0]-s[0],u[1]-s[1]],f=[c[0]-l[0],c[1]-l[1]],0!=(h=f)[0]*(g=p)[1]-h[1]*g[0]&&Ut(s,u,l,c)&&Ut(l,c,s,u))return!0;var s,u,l,c,h,g,p,f;return!1}function xt(t,e){for(var r=0;r<t.length;++r)if(!bt(t[r],e))return!1;for(var n=0;n<t.length-1;++n)if(Ct(t[n],t[n+1],e))return!1;return!0}function At(t,e){for(var r=0;r<e.length;r++)if(xt(t,e[r]))return!0;return!1}function St(t,e,r){for(var n=[],i=0;i<t.length;i++){for(var o=[],a=0;a<t[i].length;a++){var s=vt(t[i][a],r);Bt(e,s),o.push(s)}n.push(o)}return n}function Lt(t,e,r){for(var n=[],i=0;i<t.length;i++){var o=St(t[i],e,r);n.push(o)}return n}function Et(t,e,r,n){if(t[0]<r[0]||t[0]>r[2]){var i=.5*n,o=t[0]-r[0]>i?-n:r[0]-t[0]>i?n:0;0===o&&(o=t[0]-r[2]>i?-n:r[2]-t[0]>i?n:0),t[0]+=o}Bt(e,t)}function wt(t,e,r,n){for(var i=8192*Math.pow(2,n.z),o=[8192*n.x,8192*n.y],a=[],s=0,u=t;s<u.length;s+=1)for(var l=0,c=u[s];l<c.length;l+=1){var h=c[l],g=[h.x+o[0],h.y+o[1]];Et(g,e,r,i),a.push(g)}return a}function Gt(t,e,r,n){for(var i,o=8192*Math.pow(2,n.z),a=[8192*n.x,8192*n.y],s=[],u=0,l=t;u<l.length;u+=1){for(var c=[],h=0,g=l[u];h<g.length;h+=1){var p=g[h],f=[p.x+a[0],p.y+a[1]];Bt(e,f),c.push(f)}s.push(c)}if(e[2]-e[0]<=o/2){(i=e)[0]=i[1]=1/0,i[2]=i[3]=-1/0;for(var d=0,y=s;d<y.length;d+=1)for(var I=0,B=y[d];I<B.length;I+=1){Et(B[I],e,r,o)}}return s}var Xt=function(t,e){this.type=V,this.geojson=t,this.geometries=e};function Dt(t){if(t instanceof yt){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof Xt)return!1;var e=!0;return t.eachChild((function(t){e&&!Dt(t)&&(e=!1)})),e}function Rt(t){if(t instanceof yt&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild((function(t){e&&!Rt(t)&&(e=!1)})),e}function Zt(t,e){if(t instanceof yt&&e.indexOf(t.name)>=0)return!1;var r=!0;return t.eachChild((function(t){r&&!Zt(t,e)&&(r=!1)})),r}Xt.parse=function(t,e){if(2!==t.length)return e.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(nt(t[1])){var r=t[1];if("FeatureCollection"===r.type)for(var n=0;n<r.features.length;++n){var i=r.features[n].geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new Xt(r,r.features[n].geometry)}else if("Feature"===r.type){var o=r.geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new Xt(r,r.geometry)}else if("Polygon"===r.type||"MultiPolygon"===r.type)return new Xt(r,r)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Xt.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){var r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){var o=St(e.coordinates,n,i),a=wt(t.geometry(),r,n,i);if(!mt(r,n))return!1;for(var s=0,u=a;s<u.length;s+=1){if(!bt(u[s],o))return!1}}if("MultiPolygon"===e.type){var l=Lt(e.coordinates,n,i),c=wt(t.geometry(),r,n,i);if(!mt(r,n))return!1;for(var h=0,g=c;h<g.length;h+=1){if(!Qt(g[h],l))return!1}}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){var r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){var o=St(e.coordinates,n,i),a=Gt(t.geometry(),r,n,i);if(!mt(r,n))return!1;for(var s=0,u=a;s<u.length;s+=1){if(!xt(u[s],o))return!1}}if("MultiPolygon"===e.type){var l=Lt(e.coordinates,n,i),c=Gt(t.geometry(),r,n,i);if(!mt(r,n))return!1;for(var h=0,g=c;h<g.length;h+=1){if(!At(g[h],l))return!1}}return!0}(t,this.geometries)}return!1},Xt.prototype.eachChild=function(){},Xt.prototype.outputDefined=function(){return!0},Xt.prototype.serialize=function(){return["within",this.geojson]};var Vt=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};Vt.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var r=t[1];return e.scope.has(r)?new Vt(r,e.scope.get(r)):e.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Vt.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Vt.prototype.eachChild=function(){},Vt.prototype.outputDefined=function(){return!1},Vt.prototype.serialize=function(){return["var",this.name]};var Ht=function(t,e,r,n,i){void 0===e&&(e=[]),void 0===n&&(n=new X),void 0===i&&(i=[]),this.registry=t,this.path=e,this.key=e.map((function(t){return"["+t+"]"})).join(""),this.scope=n,this.errors=i,this.expectedType=r};function kt(t,e){for(var r,n,i=t.length-1,o=0,a=i,s=0;o<=a;)if(r=t[s=Math.floor((o+a)/2)],n=t[s+1],r<=e){if(s===i||e<n)return s;o=s+1}else{if(!(r>e))throw new st("Input is not a number.");a=s-1}return 0}Ht.prototype.parse=function(t,e,r,n,i){return void 0===i&&(i={}),e?this.concat(e,r,n)._parse(t,i):this._parse(t,i)},Ht.prototype._parse=function(t,e){function r(t,e,r){return"assert"===r?new lt(e,[t]):"coerce"===r?new pt(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var n=t[0];if("string"!=typeof n)return this.error("Expression name must be a string, but found "+Object(i.a)(n)+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var o=this.registry[n];if(o){var a=o.parse(t,this);if(!a)return null;if(this.expectedType){var s=this.expectedType,u=a.type;if("string"!==s.kind&&"number"!==s.kind&&"boolean"!==s.kind&&"object"!==s.kind&&"array"!==s.kind||"value"!==u.kind)if("color"!==s.kind&&"formatted"!==s.kind&&"resolvedImage"!==s.kind||"value"!==u.kind&&"string"!==u.kind){if(this.checkSubtype(s,u))return null}else a=r(a,s,e.typeAnnotation||"coerce");else a=r(a,s,e.typeAnnotation||"assert")}if(!(a instanceof at)&&"resolvedImage"!==a.type.kind&&function t(e){if(e instanceof Vt)return t(e.boundExpression);if(e instanceof yt&&"error"===e.name)return!1;if(e instanceof It)return!1;if(e instanceof Xt)return!1;var r=e instanceof pt||e instanceof lt,n=!0;if(e.eachChild((function(e){n=r?n&&t(e):n&&e instanceof at})),!n)return!1;return Dt(e)&&Zt(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(a)){var l=new dt;try{a=new at(a.type,a.evaluate(l))}catch(t){return this.error(t.message),null}}return a}return this.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"===Object(i.a)(t)?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+Object(i.a)(t)+" instead.")},Ht.prototype.concat=function(t,e,r){var n="number"==typeof t?this.path.concat(t):this.path,i=r?this.scope.concat(r):this.scope;return new Ht(this.registry,n,e||null,i,this.errors)},Ht.prototype.error=function(t){for(var e=arguments,r=[],n=arguments.length-1;n-- >0;)r[n]=e[n+1];var i=""+this.key+r.map((function(t){return"["+t+"]"})).join("");this.errors.push(new G(i,t))},Ht.prototype.checkSubtype=function(t,e){var r=_(t,e);return r&&this.error(r),r};var Nt=function(t,e,r){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var n=0,i=r;n<i.length;n+=1){var o=i[n],a=o[0],s=o[1];this.labels.push(a),this.outputs.push(s)}};Nt.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var r=e.parse(t[1],1,R);if(!r)return null;var n=[],i=null;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var o=1;o<t.length;o+=2){var a=1===o?-1/0:t[o],s=t[o+1],u=o,l=o+1;if("number"!=typeof a)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(n.length&&n[n.length-1][0]>=a)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var c=e.parse(s,l,i);if(!c)return null;i=i||c.type,n.push([a,c])}return new Nt(i,r,n)},Nt.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);var n=this.input.evaluate(t);if(n<=e[0])return r[0].evaluate(t);var i=e.length;return n>=e[i-1]?r[i-1].evaluate(t):r[kt(e,n)].evaluate(t)},Nt.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1){t(r[e])}},Nt.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},Nt.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var Wt=Mt;function Mt(t,e,r,n){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=r,this.p2y=n}function Jt(t,e,r){return t*(1-r)+e*r}Mt.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},Mt.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},Mt.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},Mt.prototype.solveCurveX=function(t,e){var r,n,i,o,a;for(void 0===e&&(e=1e-6),i=t,a=0;a<8;a++){if(o=this.sampleCurveX(i)-t,Math.abs(o)<e)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=o/s}if((i=t)<(r=0))return r;if(i>(n=1))return n;for(;r<n;){if(o=this.sampleCurveX(i),Math.abs(o-t)<e)return i;t>o?r=i:n=i,i=.5*(n-r)+r}return i},Mt.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var Yt=Object.freeze({__proto__:null,number:Jt,color:function(t,e,r){return new P(Jt(t.r,e.r,r),Jt(t.g,e.g,r),Jt(t.b,e.b,r),Jt(t.a,e.a,r))},array:function(t,e,r){return t.map((function(t,n){return Jt(t,e[n],r)}))}}),Tt=6/29,Kt=3*Tt*Tt,_t=Math.PI/180,zt=180/Math.PI;function Ot(t){return t>.008856451679035631?Math.pow(t,1/3):t/Kt+4/29}function jt(t){return t>Tt?t*t*t:Kt*(t-4/29)}function Pt(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function qt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function $t(t){var e=qt(t.r),r=qt(t.g),n=qt(t.b),i=Ot((.4124564*e+.3575761*r+.1804375*n)/.95047),o=Ot((.2126729*e+.7151522*r+.072175*n)/1);return{l:116*o-16,a:500*(i-o),b:200*(o-Ot((.0193339*e+.119192*r+.9503041*n)/1.08883)),alpha:t.a}}function te(t){var e=(t.l+16)/116,r=isNaN(t.a)?e:e+t.a/500,n=isNaN(t.b)?e:e-t.b/200;return e=1*jt(e),r=.95047*jt(r),n=1.08883*jt(n),new P(Pt(3.2404542*r-1.5371385*e-.4985314*n),Pt(-.969266*r+1.8760108*e+.041556*n),Pt(.0556434*r-.2040259*e+1.0572252*n),t.alpha)}function ee(t,e,r){var n=e-t;return t+r*(n>180||n<-180?n-360*Math.round(n/360):n)}var re={forward:$t,reverse:te,interpolate:function(t,e,r){return{l:Jt(t.l,e.l,r),a:Jt(t.a,e.a,r),b:Jt(t.b,e.b,r),alpha:Jt(t.alpha,e.alpha,r)}}},ne={forward:function(t){var e=$t(t),r=e.l,n=e.a,i=e.b,o=Math.atan2(i,n)*zt;return{h:o<0?o+360:o,c:Math.sqrt(n*n+i*i),l:r,alpha:t.a}},reverse:function(t){var e=t.h*_t,r=t.c;return te({l:t.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:t.alpha})},interpolate:function(t,e,r){return{h:ee(t.h,e.h,r),c:Jt(t.c,e.c,r),l:Jt(t.l,e.l,r),alpha:Jt(t.alpha,e.alpha,r)}}},ie=Object.freeze({__proto__:null,lab:re,hcl:ne}),oe=function(t,e,r,n,i){this.type=t,this.operator=e,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(var o=0,a=i;o<a.length;o+=1){var s=a[o],u=s[0],l=s[1];this.labels.push(u),this.outputs.push(l)}};function ae(t,e,r,n){var i=n-r,o=t-r;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}oe.interpolationFactor=function(t,e,r,n){var i=0;if("exponential"===t.name)i=ae(e,t.base,r,n);else if("linear"===t.name)i=ae(e,1,r,n);else if("cubic-bezier"===t.name){var o=t.controlPoints;i=new Wt(o[0],o[1],o[2],o[3]).solve(ae(e,1,r,n))}return i},oe.parse=function(t,e){var r=t[0],n=t[1],i=t[2],o=t.slice(3);if(!Array.isArray(n)||0===n.length)return e.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){var a=n[1];if("number"!=typeof a)return e.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:a}}else{if("cubic-bezier"!==n[0])return e.error("Unknown interpolation type "+String(n[0]),1,0);var s=n.slice(1);if(4!==s.length||s.some((function(t){return"number"!=typeof t||t<0||t>1})))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:s}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(i=e.parse(i,2,R)))return null;var u=[],l=null;"interpolate-hcl"===r||"interpolate-lab"===r?l=H:e.expectedType&&"value"!==e.expectedType.kind&&(l=e.expectedType);for(var c=0;c<o.length;c+=2){var h=o[c],g=o[c+1],p=c+3,f=c+4;if("number"!=typeof h)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(u.length&&u[u.length-1][0]>=h)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);var d=e.parse(g,f,l);if(!d)return null;l=l||d.type,u.push([h,d])}return"number"===l.kind||"color"===l.kind||"array"===l.kind&&"number"===l.itemType.kind&&"number"==typeof l.N?new oe(l,r,n,i,u):e.error("Type "+T(l)+" is not interpolatable.")},oe.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);var n=this.input.evaluate(t);if(n<=e[0])return r[0].evaluate(t);var i=e.length;if(n>=e[i-1])return r[i-1].evaluate(t);var o=kt(e,n),a=e[o],s=e[o+1],u=oe.interpolationFactor(this.interpolation,n,a,s),l=r[o].evaluate(t),c=r[o+1].evaluate(t);return"interpolate"===this.operator?Yt[this.type.kind.toLowerCase()](l,c,u):"interpolate-hcl"===this.operator?ne.reverse(ne.interpolate(ne.forward(l),ne.forward(c),u)):re.reverse(re.interpolate(re.forward(l),re.forward(c),u))},oe.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1){t(r[e])}},oe.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},oe.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],r=0;r<this.labels.length;r++)e.push(this.labels[r],this.outputs[r].serialize());return e};var se=function(t,e){this.type=t,this.args=e};se.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var r=null,n=e.expectedType;n&&"value"!==n.kind&&(r=n);for(var i=[],o=0,a=t.slice(1);o<a.length;o+=1){var s=a[o],u=e.parse(s,1+i.length,r,void 0,{typeAnnotation:"omit"});if(!u)return null;r=r||u.type,i.push(u)}var l=n&&i.some((function(t){return _(n,t.type)}));return new se(l?N:r,i)},se.prototype.evaluate=function(t){for(var e,r=null,n=0,i=0,o=this.args;i<o.length;i+=1){if(n++,(r=o[i].evaluate(t))&&r instanceof et&&!r.available&&(e||(e=r.name),r=null,n===this.args.length&&(r=e)),null!==r)break}return r},se.prototype.eachChild=function(t){this.args.forEach(t)},se.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},se.prototype.serialize=function(){var t=["coalesce"];return this.eachChild((function(e){t.push(e.serialize())})),t};var ue=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};ue.prototype.evaluate=function(t){return this.result.evaluate(t)},ue.prototype.eachChild=function(t){for(var e=0,r=this.bindings;e<r.length;e+=1){t(r[e][1])}t(this.result)},ue.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var r=[],n=1;n<t.length-1;n+=2){var o=t[n];if("string"!=typeof o)return e.error("Expected string, but found "+Object(i.a)(o)+" instead.",n);if(/[^a-zA-Z0-9_]/.test(o))return e.error("Variable names must contain only alphanumeric characters or '_'.",n);var a=e.parse(t[n+1],n+1);if(!a)return null;r.push([o,a])}var s=e.parse(t[t.length-1],t.length-1,e.expectedType,r);return s?new ue(r,s):null},ue.prototype.outputDefined=function(){return this.result.outputDefined()},ue.prototype.serialize=function(){for(var t=["let"],e=0,r=this.bindings;e<r.length;e+=1){var n=r[e],i=n[0],o=n[1];t.push(i,o.serialize())}return t.push(this.result.serialize()),t};var le=function(t,e,r){this.type=t,this.index=e,this.input=r};le.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,R),n=e.parse(t[2],2,Y(e.expectedType||N));if(!r||!n)return null;var i=n.type;return new le(i.itemType,r,n)},le.prototype.evaluate=function(t){var e=this.index.evaluate(t),r=this.input.evaluate(t);if(e<0)throw new st("Array index out of bounds: "+e+" < 0.");if(e>=r.length)throw new st("Array index out of bounds: "+e+" > "+(r.length-1)+".");if(e!==Math.floor(e))throw new st("Array index must be an integer, but found "+e+" instead.");return r[e]},le.prototype.eachChild=function(t){t(this.index),t(this.input)},le.prototype.outputDefined=function(){return!1},le.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var ce=function(t,e){this.type=V,this.needle=t,this.haystack=e};ce.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,N),n=e.parse(t[2],2,N);return r&&n?z(r.type,[V,Z,R,D,N])?new ce(r,n):e.error("Expected first argument to be of type boolean, string, number or null, but found "+T(r.type)+" instead"):null},ce.prototype.evaluate=function(t){var e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!r)return!1;if(!O(e,["boolean","string","number","null"]))throw new st("Expected first argument to be of type boolean, string, number or null, but found "+T(it(e))+" instead.");if(!O(r,["string","array"]))throw new st("Expected second argument to be of type array or string, but found "+T(it(r))+" instead.");return r.indexOf(e)>=0},ce.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},ce.prototype.outputDefined=function(){return!0},ce.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var he=function(t,e,r){this.type=R,this.needle=t,this.haystack=e,this.fromIndex=r};he.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,N),n=e.parse(t[2],2,N);if(!r||!n)return null;if(!z(r.type,[V,Z,R,D,N]))return e.error("Expected first argument to be of type boolean, string, number or null, but found "+T(r.type)+" instead");if(4===t.length){var i=e.parse(t[3],3,R);return i?new he(r,n,i):null}return new he(r,n)},he.prototype.evaluate=function(t){var e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!O(e,["boolean","string","number","null"]))throw new st("Expected first argument to be of type boolean, string, number or null, but found "+T(it(e))+" instead.");if(!O(r,["string","array"]))throw new st("Expected second argument to be of type array or string, but found "+T(it(r))+" instead.");if(this.fromIndex){var n=this.fromIndex.evaluate(t);return r.indexOf(e,n)}return r.indexOf(e)},he.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},he.prototype.outputDefined=function(){return!1},he.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var ge=function(t,e,r,n,i,o){this.inputType=t,this.type=e,this.input=r,this.cases=n,this.outputs=i,this.otherwise=o};ge.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var r,n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var i={},o=[],a=2;a<t.length-1;a+=2){var s=t[a],u=t[a+1];Array.isArray(s)||(s=[s]);var l=e.concat(a);if(0===s.length)return l.error("Expected at least one branch label.");for(var c=0,h=s;c<h.length;c+=1){var g=h[c];if("number"!=typeof g&&"string"!=typeof g)return l.error("Branch labels must be numbers or strings.");if("number"==typeof g&&Math.abs(g)>Number.MAX_SAFE_INTEGER)return l.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof g&&Math.floor(g)!==g)return l.error("Numeric branch labels must be integer values.");if(r){if(l.checkSubtype(r,it(g)))return null}else r=it(g);if(void 0!==i[String(g)])return l.error("Branch labels must be unique.");i[String(g)]=o.length}var p=e.parse(u,a,n);if(!p)return null;n=n||p.type,o.push(p)}var f=e.parse(t[1],1,N);if(!f)return null;var d=e.parse(t[t.length-1],t.length-1,n);return d?"value"!==f.type.kind&&e.concat(1).checkSubtype(r,f.type)?null:new ge(r,n,f,i,o,d):null},ge.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(it(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},ge.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},ge.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))&&this.otherwise.outputDefined()},ge.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],r=[],n={},i=0,o=Object.keys(this.cases).sort();i<o.length;i+=1){var a=o[i];void 0===(h=n[this.cases[a]])?(n[this.cases[a]]=r.length,r.push([this.cases[a],[a]])):r[h][1].push(a)}for(var s=function(e){return"number"===t.inputType.kind?Number(e):e},u=0,l=r;u<l.length;u+=1){var c=l[u],h=c[0],g=c[1];1===g.length?e.push(s(g[0])):e.push(g.map(s)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e};var pe=function(t,e,r){this.type=t,this.branches=e,this.otherwise=r};pe.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var n=[],i=1;i<t.length-1;i+=2){var o=e.parse(t[i],i,V);if(!o)return null;var a=e.parse(t[i+1],i+1,r);if(!a)return null;n.push([o,a]),r=r||a.type}var s=e.parse(t[t.length-1],t.length-1,r);return s?new pe(r,n,s):null},pe.prototype.evaluate=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var n=r[e],i=n[0],o=n[1];if(i.evaluate(t))return o.evaluate(t)}return this.otherwise.evaluate(t)},pe.prototype.eachChild=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var n=r[e],i=n[0],o=n[1];t(i),t(o)}t(this.otherwise)},pe.prototype.outputDefined=function(){return this.branches.every((function(t){t[0];return t[1].outputDefined()}))&&this.otherwise.outputDefined()},pe.prototype.serialize=function(){var t=["case"];return this.eachChild((function(e){t.push(e.serialize())})),t};var fe=function(t,e,r,n){this.type=t,this.input=e,this.beginIndex=r,this.endIndex=n};function de(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function ye(t,e,r,n){return 0===n.compare(e,r)}function Ie(t,e,r){var n="=="!==t&&"!="!==t;return function(){function i(t,e,r){this.type=V,this.lhs=t,this.rhs=e,this.collator=r,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}return i.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var r=t[0],o=e.parse(t[1],1,N);if(!o)return null;if(!de(r,o.type))return e.concat(1).error('"'+r+"\" comparisons are not supported for type '"+T(o.type)+"'.");var a=e.parse(t[2],2,N);if(!a)return null;if(!de(r,a.type))return e.concat(2).error('"'+r+"\" comparisons are not supported for type '"+T(a.type)+"'.");if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot compare types '"+T(o.type)+"' and '"+T(a.type)+"'.");n&&("value"===o.type.kind&&"value"!==a.type.kind?o=new lt(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new lt(o.type,[a])));var s=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(s=e.parse(t[3],3,W)))return null}return new i(o,a,s)},i.prototype.evaluate=function(i){var o=this.lhs.evaluate(i),a=this.rhs.evaluate(i);if(n&&this.hasUntypedArgument){var s=it(o),u=it(a);if(s.kind!==u.kind||"string"!==s.kind&&"number"!==s.kind)throw new st('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+s.kind+", "+u.kind+") instead.")}if(this.collator&&!n&&this.hasUntypedArgument){var l=it(o),c=it(a);if("string"!==l.kind||"string"!==c.kind)return e(i,o,a)}return this.collator?r(i,o,a,this.collator.evaluate(i)):e(i,o,a)},i.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},i.prototype.outputDefined=function(){return!0},i.prototype.serialize=function(){var e=[t];return this.eachChild((function(t){e.push(t.serialize())})),e},i}()}fe.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,N),n=e.parse(t[2],2,R);if(!r||!n)return null;if(!z(r.type,[Y(N),Z,N]))return e.error("Expected first argument to be of type array or string, but found "+T(r.type)+" instead");if(4===t.length){var i=e.parse(t[3],3,R);return i?new fe(r.type,r,n,i):null}return new fe(r.type,r,n)},fe.prototype.evaluate=function(t){var e=this.input.evaluate(t),r=this.beginIndex.evaluate(t);if(!O(e,["string","array"]))throw new st("Expected first argument to be of type array or string, but found "+T(it(e))+" instead.");if(this.endIndex){var n=this.endIndex.evaluate(t);return e.slice(r,n)}return e.slice(r)},fe.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},fe.prototype.outputDefined=function(){return!1},fe.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Be=Ie("==",(function(t,e,r){return e===r}),ye),me=Ie("!=",(function(t,e,r){return e!==r}),(function(t,e,r,n){return!ye(0,e,r,n)})),ve=Ie("<",(function(t,e,r){return e<r}),(function(t,e,r,n){return n.compare(e,r)<0})),Fe=Ie(">",(function(t,e,r){return e>r}),(function(t,e,r,n){return n.compare(e,r)>0})),be=Ie("<=",(function(t,e,r){return e<=r}),(function(t,e,r,n){return n.compare(e,r)<=0})),Qe=Ie(">=",(function(t,e,r){return e>=r}),(function(t,e,r,n){return n.compare(e,r)>=0})),Ue=function(t,e,r,n,i){this.type=Z,this.number=t,this.locale=e,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=i};Ue.parse=function(t,e){if(3!==t.length)return e.error("Expected two arguments.");var r=e.parse(t[1],1,R);if(!r)return null;var n=t[2];if("object"!==Object(i.a)(n)||Array.isArray(n))return e.error("NumberFormat options argument must be an object.");var o=null;if(n.locale&&!(o=e.parse(n.locale,1,Z)))return null;var a=null;if(n.currency&&!(a=e.parse(n.currency,1,Z)))return null;var s=null;if(n["min-fraction-digits"]&&!(s=e.parse(n["min-fraction-digits"],1,R)))return null;var u=null;return n["max-fraction-digits"]&&!(u=e.parse(n["max-fraction-digits"],1,R))?null:new Ue(r,o,a,s,u)},Ue.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},Ue.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},Ue.prototype.outputDefined=function(){return!1},Ue.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var Ce=function(t){this.type=R,this.input=t};Ce.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?e.error("Expected argument of type string or array, but found "+T(r.type)+" instead."):new Ce(r):null},Ce.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new st("Expected value to be of type string or array, but found "+T(it(e))+" instead.")},Ce.prototype.eachChild=function(t){t(this.input)},Ce.prototype.outputDefined=function(){return!1},Ce.prototype.serialize=function(){var t=["length"];return this.eachChild((function(e){t.push(e.serialize())})),t};var xe={"==":Be,"!=":me,">":Fe,"<":ve,">=":Qe,"<=":be,array:lt,at:le,boolean:lt,case:pe,coalesce:se,collator:It,format:ct,image:ht,in:ce,"index-of":he,interpolate:oe,"interpolate-hcl":oe,"interpolate-lab":oe,length:Ce,let:ue,literal:at,match:ge,number:lt,"number-format":Ue,object:lt,slice:fe,step:Nt,string:lt,"to-boolean":pt,"to-color":pt,"to-number":pt,"to-string":pt,var:Vt,within:Xt};function Ae(t,e){var r=e[0],n=e[1],i=e[2],o=e[3];r=r.evaluate(t),n=n.evaluate(t),i=i.evaluate(t);var a=o?o.evaluate(t):1,s=rt(r,n,i,a);if(s)throw new st(s);return new P(r/255*a,n/255*a,i/255*a,a)}function Se(t,e){return t in e}function Le(t,e){var r=e[t];return void 0===r?null:r}function Ee(t){return{type:t}}function we(t){return{result:"success",value:t}}function Ge(t){return{result:"error",value:t}}function Xe(t){return!!t.expression&&t.expression.interpolated}function De(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":Object(i.a)(t)}function Re(t){return"object"===Object(i.a)(t)&&null!==t&&!Array.isArray(t)}function Ze(t){return t}function Ve(t,e,r){return void 0!==t?t:void 0!==e?e:void 0!==r?r:void 0}function He(t,e,r,n,o){return Ve(Object(i.a)(r)===o?n[r]:void 0,t.default,e.default)}function ke(t,e,r){if("number"!==De(r))return Ve(t.default,e.default);var n=t.stops.length;if(1===n)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];var i=kt(t.stops.map((function(t){return t[0]})),r);return t.stops[i][1]}function Ne(t,e,r){var n=void 0!==t.base?t.base:1;if("number"!==De(r))return Ve(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];var o=kt(t.stops.map((function(t){return t[0]})),r),a=function(t,e,r,n){var i=n-r,o=t-r;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}(r,n,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],u=t.stops[o+1][1],l=Yt[e.type]||Ze;if(t.colorSpace&&"rgb"!==t.colorSpace){var c=ie[t.colorSpace];l=function(t,e){return c.reverse(c.interpolate(c.forward(t),c.forward(e),a))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var t=arguments,e=[],r=arguments.length;r--;)e[r]=t[r];var n=s.evaluate.apply(void 0,e),i=u.evaluate.apply(void 0,e);if(void 0!==n&&void 0!==i)return l(n,i,a)}}:l(s,u,a)}function We(t,e,r){return"color"===e.type?r=P.parse(r):"formatted"===e.type?r=tt.fromString(r.toString()):"resolvedImage"===e.type?r=et.fromString(r.toString()):De(r)===e.type||"enum"===e.type&&e.values[r]||(r=void 0),Ve(r,t.default,e.default)}yt.register(xe,{error:[{kind:"error"},[Z],function(t,e){var r=e[0];throw new st(r.evaluate(t))}],typeof:[Z,[N],function(t,e){return T(it(e[0].evaluate(t)))}],"to-rgba":[Y(R,4),[H],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[H,[R,R,R],Ae],rgba:[H,[R,R,R,R],Ae],has:{type:V,overloads:[[[Z],function(t,e){return Se(e[0].evaluate(t),t.properties())}],[[Z,k],function(t,e){var r=e[0],n=e[1];return Se(r.evaluate(t),n.evaluate(t))}]]},get:{type:N,overloads:[[[Z],function(t,e){return Le(e[0].evaluate(t),t.properties())}],[[Z,k],function(t,e){var r=e[0],n=e[1];return Le(r.evaluate(t),n.evaluate(t))}]]},"feature-state":[N,[Z],function(t,e){return Le(e[0].evaluate(t),t.featureState||{})}],properties:[k,[],function(t){return t.properties()}],"geometry-type":[Z,[],function(t){return t.geometryType()}],id:[N,[],function(t){return t.id()}],zoom:[R,[],function(t){return t.globals.zoom}],"heatmap-density":[R,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[R,[],function(t){return t.globals.lineProgress||0}],accumulated:[N,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[R,Ee(R),function(t,e){for(var r=0,n=0,i=e;n<i.length;n+=1){r+=i[n].evaluate(t)}return r}],"*":[R,Ee(R),function(t,e){for(var r=1,n=0,i=e;n<i.length;n+=1){r*=i[n].evaluate(t)}return r}],"-":{type:R,overloads:[[[R,R],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)-n.evaluate(t)}],[[R],function(t,e){return-e[0].evaluate(t)}]]},"/":[R,[R,R],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)/n.evaluate(t)}],"%":[R,[R,R],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)%n.evaluate(t)}],ln2:[R,[],function(){return Math.LN2}],pi:[R,[],function(){return Math.PI}],e:[R,[],function(){return Math.E}],"^":[R,[R,R],function(t,e){var r=e[0],n=e[1];return Math.pow(r.evaluate(t),n.evaluate(t))}],sqrt:[R,[R],function(t,e){var r=e[0];return Math.sqrt(r.evaluate(t))}],log10:[R,[R],function(t,e){var r=e[0];return Math.log(r.evaluate(t))/Math.LN10}],ln:[R,[R],function(t,e){var r=e[0];return Math.log(r.evaluate(t))}],log2:[R,[R],function(t,e){var r=e[0];return Math.log(r.evaluate(t))/Math.LN2}],sin:[R,[R],function(t,e){var r=e[0];return Math.sin(r.evaluate(t))}],cos:[R,[R],function(t,e){var r=e[0];return Math.cos(r.evaluate(t))}],tan:[R,[R],function(t,e){var r=e[0];return Math.tan(r.evaluate(t))}],asin:[R,[R],function(t,e){var r=e[0];return Math.asin(r.evaluate(t))}],acos:[R,[R],function(t,e){var r=e[0];return Math.acos(r.evaluate(t))}],atan:[R,[R],function(t,e){var r=e[0];return Math.atan(r.evaluate(t))}],min:[R,Ee(R),function(t,e){return Math.min.apply(Math,e.map((function(e){return e.evaluate(t)})))}],max:[R,Ee(R),function(t,e){return Math.max.apply(Math,e.map((function(e){return e.evaluate(t)})))}],abs:[R,[R],function(t,e){var r=e[0];return Math.abs(r.evaluate(t))}],round:[R,[R],function(t,e){var r=e[0].evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[R,[R],function(t,e){var r=e[0];return Math.floor(r.evaluate(t))}],ceil:[R,[R],function(t,e){var r=e[0];return Math.ceil(r.evaluate(t))}],"filter-==":[V,[Z,N],function(t,e){var r=e[0],n=e[1];return t.properties()[r.value]===n.value}],"filter-id-==":[V,[N],function(t,e){var r=e[0];return t.id()===r.value}],"filter-type-==":[V,[Z],function(t,e){var r=e[0];return t.geometryType()===r.value}],"filter-<":[V,[Z,N],function(t,e){var r=e[0],n=e[1],o=t.properties()[r.value],a=n.value;return Object(i.a)(o)===Object(i.a)(a)&&o<a}],"filter-id-<":[V,[N],function(t,e){var r=e[0],n=t.id(),o=r.value;return Object(i.a)(n)===Object(i.a)(o)&&n<o}],"filter->":[V,[Z,N],function(t,e){var r=e[0],n=e[1],o=t.properties()[r.value],a=n.value;return Object(i.a)(o)===Object(i.a)(a)&&o>a}],"filter-id->":[V,[N],function(t,e){var r=e[0],n=t.id(),o=r.value;return Object(i.a)(n)===Object(i.a)(o)&&n>o}],"filter-<=":[V,[Z,N],function(t,e){var r=e[0],n=e[1],o=t.properties()[r.value],a=n.value;return Object(i.a)(o)===Object(i.a)(a)&&o<=a}],"filter-id-<=":[V,[N],function(t,e){var r=e[0],n=t.id(),o=r.value;return Object(i.a)(n)===Object(i.a)(o)&&n<=o}],"filter->=":[V,[Z,N],function(t,e){var r=e[0],n=e[1],o=t.properties()[r.value],a=n.value;return Object(i.a)(o)===Object(i.a)(a)&&o>=a}],"filter-id->=":[V,[N],function(t,e){var r=e[0],n=t.id(),o=r.value;return Object(i.a)(n)===Object(i.a)(o)&&n>=o}],"filter-has":[V,[N],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[V,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[V,[Y(Z)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[V,[Y(N)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[V,[Z,Y(N)],function(t,e){var r=e[0];return e[1].value.indexOf(t.properties()[r.value])>=0}],"filter-in-large":[V,[Z,Y(N)],function(t,e){var r=e[0],n=e[1];return function(t,e,r,n){for(;r<=n;){var i=r+n>>1;if(e[i]===t)return!0;e[i]>t?n=i-1:r=i+1}return!1}(t.properties()[r.value],n.value,0,n.value.length-1)}],all:{type:V,overloads:[[[V,V],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)&&n.evaluate(t)}],[Ee(V),function(t,e){for(var r=0,n=e;r<n.length;r+=1){if(!n[r].evaluate(t))return!1}return!0}]]},any:{type:V,overloads:[[[V,V],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)||n.evaluate(t)}],[Ee(V),function(t,e){for(var r=0,n=e;r<n.length;r+=1){if(n[r].evaluate(t))return!0}return!1}]]},"!":[V,[V],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[V,[Z],function(t,e){var r=e[0],n=t.globals&&t.globals.isSupportedScript;return!n||n(r.evaluate(t))}],upcase:[Z,[Z],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[Z,[Z],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[Z,Ee(N),function(t,e){return e.map((function(e){return ot(e.evaluate(t))})).join("")}],"resolved-locale":[Z,[W],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var Me=function(t,e){var r;this.expression=t,this._warningHistory={},this._evaluator=new dt,this._defaultValue=e?"color"===(r=e).type&&Re(r.default)?new P(0,0,0,0):"color"===r.type?P.parse(r.default)||null:void 0===r.default?null:r.default:null,this._enumValues=e&&"enum"===e.type?e.values:null};function Je(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in xe}function Ye(t,e){var r=new Ht(xe,[],e?function(t){var e={color:H,string:Z,number:R,enum:Z,boolean:V,formatted:M,resolvedImage:J};if("array"===t.type)return Y(e[t.value]||N,t.length);return e[t.type]}(e):void 0),n=r.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return n?we(new Me(n,e)):Ge(r.errors)}Me.prototype.evaluateWithoutErrorHandling=function(t,e,r,n,i,o){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)},Me.prototype.evaluate=function(t,e,r,n,i,o){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o||null;try{var a=this.expression.evaluate(this._evaluator);if(null==a||"number"==typeof a&&a!=a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new st("Expected value to be one of "+Object.keys(this._enumValues).map((function(t){return JSON.stringify(t)})).join(", ")+", but found "+JSON.stringify(a)+" instead.");return a}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var Te=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Rt(e.expression)};Te.prototype.evaluateWithoutErrorHandling=function(t,e,r,n,i,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,n,i,o)},Te.prototype.evaluate=function(t,e,r,n,i,o){return this._styleExpression.evaluate(t,e,r,n,i,o)};var Ke=function(t,e,r,n){this.kind=t,this.zoomStops=r,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Rt(e.expression),this.interpolationType=n};function _e(t,e){if("error"===(t=Ye(t,e)).result)return t;var r,n=t.value.expression,i=Dt(n);if(!i&&("data-driven"!==(r=e)["property-type"]&&"cross-faded-data-driven"!==r["property-type"]))return Ge([new G("","data expressions not supported")]);var o=Zt(n,["zoom"]);if(!o&&!function(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}(e))return Ge([new G("","zoom expressions not supported")]);var a=function t(e){var r=null;if(e instanceof ue)r=t(e.result);else if(e instanceof se)for(var n=0,i=e.args;n<i.length;n+=1){var o=i[n];if(r=t(o))break}else(e instanceof Nt||e instanceof oe)&&e.input instanceof yt&&"zoom"===e.input.name&&(r=e);if(r instanceof G)return r;return e.eachChild((function(e){var n=t(e);n instanceof G?r=n:!r&&n?r=new G("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&n&&r!==n&&(r=new G("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),r}(n);if(!a&&!o)return Ge([new G("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(a instanceof G)return Ge([a]);if(a instanceof oe&&!Xe(e))return Ge([new G("",'"interpolate" expressions cannot be used with this property')]);if(!a)return we(new Te(i?"constant":"source",t.value));var s=a instanceof oe?a.interpolation:void 0;return we(new Ke(i?"camera":"composite",t.value,a.labels,s))}Ke.prototype.evaluateWithoutErrorHandling=function(t,e,r,n,i,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,n,i,o)},Ke.prototype.evaluate=function(t,e,r,n,i,o){return this._styleExpression.evaluate(t,e,r,n,i,o)},Ke.prototype.interpolationFactor=function(t,e,r){return this.interpolationType?oe.interpolationFactor(this.interpolationType,t,e,r):0};var ze=function(t,e){this._parameters=t,this._specification=e,w(this,function t(e,r){var n,o,a,s="color"===r.type,u=e.stops&&"object"===Object(i.a)(e.stops[0][0]),l=u||void 0!==e.property,c=u||!l,h=e.type||(Xe(r)?"exponential":"interval");if(s&&((e=w({},e)).stops&&(e.stops=e.stops.map((function(t){return[t[0],P.parse(t[1])]}))),e.default?e.default=P.parse(e.default):e.default=P.parse(r.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!ie[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if("exponential"===h)n=Ne;else if("interval"===h)n=ke;else if("categorical"===h){n=He,o=Object.create(null);for(var g=0,p=e.stops;g<p.length;g+=1){var f=p[g];o[f[0]]=f[1]}a=Object(i.a)(e.stops[0][0])}else{if("identity"!==h)throw new Error('Unknown function type "'+h+'"');n=We}if(u){for(var d={},y=[],I=0;I<e.stops.length;I++){var B=e.stops[I],m=B[0].zoom;void 0===d[m]&&(d[m]={zoom:m,type:e.type,property:e.property,default:e.default,stops:[]},y.push(m)),d[m].stops.push([B[0].value,B[1]])}for(var v=[],F=0,b=y;F<b.length;F+=1){var Q=b[F];v.push([d[Q].zoom,t(d[Q],r)])}var U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:oe.interpolationFactor.bind(void 0,U),zoomStops:v.map((function(t){return t[0]})),evaluate:function(t,n){var i=t.zoom;return Ne({stops:v,base:e.base},r,i).evaluate(i,n)}}}if(c){var C="exponential"===h?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:C,interpolationFactor:oe.interpolationFactor.bind(void 0,C),zoomStops:e.stops.map((function(t){return t[0]})),evaluate:function(t){var i=t.zoom;return n(e,r,i,o,a)}}}return{kind:"source",evaluate:function(t,i){var s=i&&i.properties?i.properties[e.property]:void 0;return void 0===s?Ve(e.default,r.default):n(e,r,s,o,a)}}}(this._parameters,this._specification))};ze.deserialize=function(t){return new ze(t._parameters,t._specification)},ze.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var Oe=C((function(t,e){var r=function(){var t=function(t,e,r,n){for(r=r||{},n=t.length;n--;r[t[n]]=e);return r},e=[1,12],r=[1,13],n=[1,9],i=[1,10],o=[1,11],a=[1,14],s=[1,15],u=[14,18,22,24],l=[18,22],c=[22,24],h={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(t,e,r,n,i,o,a){var s=o.length-1;switch(i){case 1:this.$=new String(t.replace(/\\(\\|")/g,"$1").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b")),this.$.__line__=this._$.first_line;break;case 2:this.$=new Number(t),this.$.__line__=this._$.first_line;break;case 3:this.$=null;break;case 4:this.$=new Boolean(!0),this.$.__line__=this._$.first_line;break;case 5:this.$=new Boolean(!1),this.$.__line__=this._$.first_line;break;case 6:return this.$=o[s-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=o[s-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[o[s-2],o[s]];break;case 16:this.$={},this.$[o[s][0]]=o[s][1];break;case 17:this.$=o[s-2],o[s-2][o[s][0]]=o[s][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[o[s]];break;case 21:this.$=o[s-2],o[s-2].push(o[s])}},table:[{3:5,4:e,5:6,6:r,7:3,8:n,9:4,10:i,11:o,12:1,13:2,15:7,16:8,17:a,23:s},{1:[3]},{14:[1,16]},t(u,[2,7]),t(u,[2,8]),t(u,[2,9]),t(u,[2,10]),t(u,[2,11]),t(u,[2,12]),t(u,[2,3]),t(u,[2,4]),t(u,[2,5]),t([14,18,21,22,24],[2,1]),t(u,[2,2]),{3:20,4:e,18:[1,17],19:18,20:19},{3:5,4:e,5:6,6:r,7:3,8:n,9:4,10:i,11:o,13:23,15:7,16:8,17:a,23:s,24:[1,21],25:22},{1:[2,6]},t(u,[2,13]),{18:[1,24],22:[1,25]},t(l,[2,16]),{21:[1,26]},t(u,[2,18]),{22:[1,28],24:[1,27]},t(c,[2,20]),t(u,[2,14]),{3:20,4:e,20:29},{3:5,4:e,5:6,6:r,7:3,8:n,9:4,10:i,11:o,13:30,15:7,16:8,17:a,23:s},t(u,[2,19]),{3:5,4:e,5:6,6:r,7:3,8:n,9:4,10:i,11:o,13:31,15:7,16:8,17:a,23:s},t(l,[2,17]),t(l,[2,15]),t(c,[2,21])],defaultActions:{16:[2,6]},parseError:function(t,e){if(!e.recoverable)throw new Error(t);this.trace(t)},parse:function(t){var e=this,r=[0],n=[null],i=[],o=this.table,a="",s=0,u=0,l=2,c=1,h=i.slice.call(arguments,1),g=Object.create(this.lexer),p={yy:{}};for(var f in this.yy)Object.prototype.hasOwnProperty.call(this.yy,f)&&(p.yy[f]=this.yy[f]);g.setInput(t,p.yy),p.yy.lexer=g,p.yy.parser=this,void 0===g.yylloc&&(g.yylloc={});var d=g.yylloc;i.push(d);var y=g.options&&g.options.ranges;function I(){var t;return"number"!=typeof(t=g.lex()||c)&&(t=e.symbols_[t]||t),t}"function"==typeof p.yy.parseError?this.parseError=p.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var B,m,v,F,b,Q,U,C,x={};;){if(m=r[r.length-1],this.defaultActions[m]?v=this.defaultActions[m]:(null==B&&(B=I()),v=o[m]&&o[m][B]),void 0===v||!v.length||!v[0]){var A="";for(b in C=[],o[m])this.terminals_[b]&&b>l&&C.push("'"+this.terminals_[b]+"'");A=g.showPosition?"Parse error on line "+(s+1)+":\n"+g.showPosition()+"\nExpecting "+C.join(", ")+", got '"+(this.terminals_[B]||B)+"'":"Parse error on line "+(s+1)+": Unexpected "+(B==c?"end of input":"'"+(this.terminals_[B]||B)+"'"),this.parseError(A,{text:g.match,token:this.terminals_[B]||B,line:g.yylineno,loc:d,expected:C})}if(v[0]instanceof Array&&v.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+B);switch(v[0]){case 1:r.push(B),n.push(g.yytext),i.push(g.yylloc),r.push(v[1]),B=null,u=g.yyleng,a=g.yytext,s=g.yylineno,d=g.yylloc;break;case 2:if(Q=this.productions_[v[1]][1],x.$=n[n.length-Q],x._$={first_line:i[i.length-(Q||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(Q||1)].first_column,last_column:i[i.length-1].last_column},y&&(x._$.range=[i[i.length-(Q||1)].range[0],i[i.length-1].range[1]]),void 0!==(F=this.performAction.apply(x,[a,u,s,p.yy,v[1],n,i].concat(h))))return F;Q&&(r=r.slice(0,-1*Q*2),n=n.slice(0,-1*Q),i=i.slice(0,-1*Q)),r.push(this.productions_[v[1]][0]),n.push(x.$),i.push(x._$),U=o[r[r.length-2]][r[r.length-1]],r.push(U);break;case 3:return!0}}return!0}},g={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,r=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var r,n,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(n=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],r=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var o in i)this[o]=i[o];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,r,n;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),o=0;o<i.length;o++)if((r=this._input.match(this.rules[i[o]]))&&(!e||r[0].length>e[0].length)){if(e=r,n=o,this.options.backtrack_lexer){if(!1!==(t=this.test_match(r,i[o])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,i[n]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,r,n){switch(r){case 0:break;case 1:return 6;case 2:return e.yytext=e.yytext.substr(1,e.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};function p(){this.yy={}}return h.lexer=g,p.prototype=h,h.Parser=p,new p}();e.parser=r,e.Parser=r.Parser,e.parse=function(){return r.parse.apply(r,arguments)}})),je=(Oe.parser,Oe.Parser,Oe.parse,{StyleExpression:Me,isExpression:Je,isExpressionFilter:function t(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var r=0,n=e.slice(1);r<n.length;r+=1){var i=n[r];if(!t(i)&&"boolean"!=typeof i)return!1}return!0;default:return!0}},createExpression:Ye,createPropertyExpression:_e,normalizePropertyExpression:function(t,e){if(Re(t))return new ze(t,e);if(Je(t)){var r=_e(t,e);if("error"===r.result)throw new Error(r.value.map((function(t){return t.key+": "+t.message})).join(", "));return r.value}var n=t;return"string"==typeof t&&"color"===e.type&&(n=P.parse(t)),{kind:"constant",evaluate:function(){return n}}},ZoomConstantExpression:Te,ZoomDependentExpression:Ke,StylePropertyFunction:ze});function Pe(t,e){if(!t)return!1;if(e=e||devicePixelRatio||1,!(t instanceof OffscreenCanvas)){var r=t.clientWidth*e,n=t.clientHeight*e;if(r<=0||n<=0)return!1;if(t.width!==r||t.height!==n)return t.width=r,t.height=n,!0}return!1}function qe(t,e,r){var n=t.createShader(e);if(t.shaderSource(n,r),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw t.deleteShader(n),new Error(t.getShaderInfoLog(n)||"");return n}function $e(t,e,r,n,i){var o=t.createTexture();return t.bindTexture(t.TEXTURE_2D,o),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e),r instanceof Uint8Array?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n,i,0,t.RGBA,t.UNSIGNED_BYTE,r):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.bindTexture(t.TEXTURE_2D,null),o}function tr(t,e){var r=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,r),e&&t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),r}var er=function(){function t(t,e,r){this.vertShader="",this.fragShader="",e&&(this.vertShader=e),r&&(this.fragShader=r),this.program=function(t,e,r){var n=qe(t,t.VERTEX_SHADER,e),i=qe(t,t.FRAGMENT_SHADER,r),o=t.createProgram();if(null!==o&&(t.attachShader(o,n),t.attachShader(o,i),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS)))throw new Error(t.getProgramInfoLog(o)||"");return o}(t,this.vertShader,this.fragShader),this.gl=t,this.textureUnit=0,this.uniformSetters=this.createUniformSetters(),this.attribSetters=this.createAttributeSetters(),this.transfromStack=[]}return t.prototype.active=function(){return this.gl.useProgram(this.program),this},t.prototype.deactive=function(){return this.gl.deleteProgram(this.program),this},t.prototype.getBindPointForSamplerType=function(t,e){return e===t.SAMPLER_2D?t.TEXTURE_2D:e===t.SAMPLER_CUBE?t.TEXTURE_CUBE_MAP:void 0},t.prototype.createUniformSetter=function(t,e){var r,n,i=this.gl,o=i.getUniformLocation(t,e.name),a=e.type,s=e.size>1&&"[0]"===e.name.substr(-3);if(a===i.FLOAT&&s)return function(t){i.uniform1fv(o,t)};if(a===i.FLOAT)return function(t){i.uniform1f(o,t)};if(a===i.FLOAT_VEC2)return function(t){i.uniform2fv(o,t)};if(a===i.FLOAT_VEC3)return function(t){i.uniform3fv(o,t)};if(a===i.FLOAT_VEC4)return function(t){i.uniform4fv(o,t)};if(a===i.INT&&s)return function(t){i.uniform1iv(o,t)};if(a===i.INT)return function(t){i.uniform1i(o,t)};if(a===i.INT_VEC2)return function(t){i.uniform2iv(o,t)};if(a===i.INT_VEC3)return function(t){i.uniform3iv(o,t)};if(a===i.INT_VEC4)return function(t){i.uniform4iv(o,t)};if(a===i.BOOL)return function(t){i.uniform1iv(o,t)};if(a===i.BOOL_VEC2)return function(t){i.uniform2iv(o,t)};if(a===i.BOOL_VEC3)return function(t){i.uniform3iv(o,t)};if(a===i.BOOL_VEC4)return function(t){i.uniform4iv(o,t)};if(a===i.FLOAT_MAT2)return function(t){i.uniformMatrix2fv(o,!1,t)};if(a===i.FLOAT_MAT3)return function(t){i.uniformMatrix3fv(o,!1,t)};if(a===i.FLOAT_MAT4)return function(t){i.uniformMatrix4fv(o,!1,t)};if((a===i.SAMPLER_2D||a===i.SAMPLER_CUBE)&&s){for(var u=[],l=0;l<e.size;++l)u.push(this.textureUnit++);return function(t,e){return function(r){i.uniform1iv(o,e),r.forEach((function(r,n){i.activeTexture(i.TEXTURE0+e[n]),void 0!==t&&i.bindTexture(t,r)}))}}(this.getBindPointForSamplerType(i,a),u)}if(a===i.SAMPLER_2D||a===i.SAMPLER_CUBE)return r=this.getBindPointForSamplerType(i,a),n=this.textureUnit++,function(t){i.uniform1i(o,n),i.activeTexture(i.TEXTURE0+n),void 0!==r&&i.bindTexture(r,t)};throw"unknown type: 0x"+a.toString(16)},t.prototype.createUniformSetters=function(){var t=this.gl;this.textureUnit=0;var e={};if(null!==this.program)for(var r=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),n=0;n<r;++n){var i=t.getActiveUniform(this.program,n);if(!i)break;var o=i.name;"[0]"===o.substr(-3)&&(o=o.substr(0,o.length-3));var a=this.createUniformSetter(this.program,i);e[o]=a}return e},t.prototype.createAttribSetter=function(t){var e=this.gl;return function(r){e.bindBuffer(e.ARRAY_BUFFER,r.buffer),e.enableVertexAttribArray(t),void 0===r.numComponents&&void 0===r.size||e.vertexAttribPointer(t,r.numComponents||r.size,r.type||e.FLOAT,r.normalize||!1,r.stride||0,r.offset||0)}},t.prototype.createAttributeSetters=function(){var t=this.gl,e={};if(null!==this.program)for(var r=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),n=0;n<r;++n){var i=t.getActiveAttrib(this.program,n);if(!i)break;var o=t.getAttribLocation(this.program,i.name);e[i.name]=this.createAttribSetter(o)}return e},t.prototype.setAttributes=function(t,e){return e=e?e.attribSetters||e:this.attribSetters,Object.keys(t).forEach((function(r){var n=e[r];n&&n(t[r])})),this},t.prototype.setUniforms=function(t,e){return e=e?e.uniformSetters||e:this.uniformSetters,Object.keys(t).forEach((function(r){var n=e[r];n&&n(t[r])})),this},t.prototype.clear=function(t){return function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3];t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(r,n,i,o),t.clearDepth(1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.enable(t.DEPTH_TEST)}(this.gl,t),this.transfromStack=[],this},t.prototype.runTimes=function(t){return this.count=t||0,this},t.prototype.resize=function(){return Pe(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this},t.prototype.draw=function(){throw new Error("should override")},t.prototype.translate=function(){throw new Error("should override")},t.prototype.rotate=function(){throw new Error("should override")},t.prototype.scale=function(){throw new Error("should override")},t}(),rr="precision mediump float;\n#define GLSLIFY 1\nuniform sampler2D u_wind;uniform sampler2D u_color_ramp;uniform vec2 u_image_res;uniform vec2 u_wind_min;uniform vec2 u_wind_max;uniform float u_opacity;varying vec2 v_tex_pos;vec2 windTexture(const vec2 uv){return texture2D(u_wind,uv).rg;}vec2 bilinearWind(const vec2 uv){vec2 px=1.0/u_image_res;vec2 vc=(floor(uv*u_image_res))*px;vec2 f=fract(uv*u_image_res);vec2 tl=windTexture(vc);vec2 tr=windTexture(vc+vec2(px.x,0));vec2 bl=windTexture(vc+vec2(0,px.y));vec2 br=windTexture(vc+px);return mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);}vec2 windSpeed(const vec2 uv){return mix(u_wind_min,u_wind_max,bilinearWind(uv));}float windSpeedMagnitude(const vec2 uv){return length(windSpeed(uv))/length(u_wind_max);}const float PI=3.14159265359;/***Converts mapbox style pseudo-mercator coordinates(this is just like mercator,but the unit isn't a meter,but 0..1*spans the entire world)into texture like WGS84 coordinates(this is just like WGS84,but instead of angles,it uses*intervals of 0..1).*/vec2 mercatorToWGS84(vec2 xy){float y=radians(180.0-xy.y*360.0);y=360.0/PI*atan(exp(y))-90.0;y=y/-180.0+0.5;return vec2(xy.x,y);}void main(){vec2 globalWGS84=mercatorToWGS84(v_tex_pos);float speed_t=windSpeedMagnitude(globalWGS84);vec2 ramp_pos=vec2(fract(16.0*speed_t),floor(16.0*speed_t)/16.0);vec4 color=texture2D(u_color_ramp,ramp_pos);gl_FragColor=vec4(floor(255.0*color*u_opacity)/255.0);}",nr="#define GLSLIFY 1\nuniform mat4 u_matrix;attribute vec2 a_position;attribute vec2 a_texCoord;uniform float u_dateline_offset;varying vec2 v_tex_pos;void main(){gl_Position=u_matrix*vec4(a_position.xy+vec2(u_dateline_offset,0),0.0,1.0);v_tex_pos=a_texCoord;}",ir=function(t){function e(e,r,n){var i=t.call(this,e,r||nr,n||rr)||this;return i.vertShader=nr,i.fragShader=rr,i}return b(e,t),e.prototype.draw=function(){var t=this.gl.TRIANGLES;return this.gl.drawArrays(t,0,this.count),this},e.prototype.translate=function(){return this},e.prototype.rotate=function(){return this},e.prototype.scale=function(){return this},e}(er),or="precision mediump float;\n#define GLSLIFY 1\nuniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform vec2 u_image_res;uniform vec2 u_range;uniform float u_opacity;varying vec2 v_tex_pos;float calcTexture(const vec2 uv){return texture2D(u_image,uv).r;}float windSpeedRelative(const vec2 uv){return texture2D(u_image,uv).r;}float bilinear(const vec2 uv){vec2 px=1.0/u_image_res;vec2 vc=(floor(uv*u_image_res))*px;vec2 f=fract(uv*u_image_res);float tl=calcTexture(vc);float tr=calcTexture(vc+vec2(px.x,0));float bl=calcTexture(vc+vec2(0,px.y));float br=calcTexture(vc+px);return mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);}float getValue(const vec2 uv){return mix(u_range.x,u_range.y,bilinear(uv));}const float PI=3.14159265359;/***Converts mapbox style pseudo-mercator coordinates(this is just like mercator,but the unit isn't a meter,but 0..1*spans the entire world)into texture like WGS84 coordinates(this is just like WGS84,but instead of angles,it uses*intervals of 0..1).*/vec2 mercatorToWGS84(vec2 xy){float y=radians(180.0-xy.y*360.0);y=360.0/PI*atan(exp(y))-90.0;y=y/-180.0+0.5;return vec2(xy.x,y);}void main(){vec2 globalWGS84=mercatorToWGS84(v_tex_pos);float value_t=length(getValue(globalWGS84))/length(u_range);vec2 ramp_pos=vec2(fract(16.0*value_t),floor(16.0*value_t)/16.0);vec4 color=texture2D(u_color_ramp,ramp_pos);gl_FragColor=vec4(floor(255.0*color*u_opacity)/255.0);}",ar="#define GLSLIFY 1\nuniform mat4 u_matrix;attribute vec2 a_position;attribute vec2 a_texCoord;uniform float u_dateline_offset;varying vec2 v_tex_pos;void main(){gl_Position=u_matrix*vec4(a_position.xy+vec2(u_dateline_offset,0),0.0,1.0);v_tex_pos=a_texCoord;}",sr=function(t){function e(e,r,n){var i=t.call(this,e,r||ar,n||or)||this;return i.vertShader=ar,i.fragShader=or,i}return b(e,t),e.prototype.draw=function(){var t=this.gl.TRIANGLES;return this.gl.drawArrays(t,0,this.count),this},e.prototype.translate=function(){return this},e.prototype.rotate=function(){return this},e.prototype.scale=function(){return this},e}(er);function ur(t){return"number"==typeof t&&!isNaN(t)}var lr=null;try{var cr="function"==typeof t.require&&r(!function(){var t=new Error("Cannot find module 'worker_threads'");throw t.code="MODULE_NOT_FOUND",t}())||"function"==typeof require&&require("worker_threads")||r(!function(){var t=new Error("Cannot find module 'worker_threads'");throw t.code="MODULE_NOT_FOUND",t}());lr=cr.Worker}catch(t){}function hr(t,e,r){var i=void 0===e?null:e,o=function(t,e){return n.from(t,"base64").toString(e?"utf16":"utf8")}(t,void 0!==r&&r),a=o.indexOf("\n",10)+1,s=o.substring(a)+(i?"//# sourceMappingURL="+i:"");return function(t){return new lr(s,Object.assign({},t,{eval:!0}))}}function gr(t,e,r){var n=void 0===e?null:e,i=function(t,e){var r=atob(t);if(e){for(var n=new Uint8Array(r.length),i=0,o=r.length;i<o;++i)n[i]=r.charCodeAt(i);return String.fromCharCode.apply(null,new Uint16Array(n.buffer))}return r}(t,void 0!==r&&r),o=i.indexOf("\n",10)+1,a=i.substring(o)+(n?"//# sourceMappingURL="+n:""),s=new Blob([a],{type:"application/javascript"});return URL.createObjectURL(s)}var pr="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0);var fr,dr,yr,Ir=(fr="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwovKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLg0KTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7IHlvdSBtYXkgbm90IHVzZQ0KdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUNCkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wDQoNClRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkNCktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRUQNCldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsDQpNRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULg0KDQpTZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMNCmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4NCioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovDQoNCmZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHsNCiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsNCiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfQ0KICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9DQogICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTsNCiAgICB9KTsNCn0NCg0KZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkgew0KICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgeyB0aHJvdyB0WzFdOyB9IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnOw0KICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCAidGhyb3ciOiB2ZXJiKDEpLCAicmV0dXJuIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnOw0KICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfQ0KICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHsNCiAgICAgICAgaWYgKGYpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLiIpOyB9DQogICAgICAgIHdoaWxlIChfKSB7IHRyeSB7DQogICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5WyJyZXR1cm4iXSA6IG9wWzBdID8geVsidGhyb3ciXSB8fCAoKHQgPSB5WyJyZXR1cm4iXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgeyByZXR1cm4gdDsgfQ0KICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSB7IG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07IH0NCiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHsNCiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9Ow0KICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTsNCiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7DQogICAgICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9DQogICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9DQogICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9DQogICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSB7IF8ub3BzLnBvcCgpOyB9DQogICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTsNCiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfSB9DQogICAgICAgIGlmIChvcFswXSAmIDUpIHsgdGhyb3cgb3BbMV07IH0gcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTsNCiAgICB9DQp9CgpmdW5jdGlvbiBjYWxjTWluTWF4KGFycmF5KSB7CiAgICB2YXIgbWluID0gSW5maW5pdHk7CiAgICB2YXIgbWF4ID0gSW5maW5pdHk7CiAgICAvLyBAZnJvbTogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTM1NDQ0NzYvaG93LXRvLWZpbmQtbWF4LWFuZC1taW4taW4tYXJyYXktdXNpbmctbWluaW11bS1jb21wYXJpc29ucwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciB2YWwgPSBhcnJheVtpXTsKICAgICAgICBpZiAobWluID09PSBJbmZpbml0eSkgewogICAgICAgICAgICBtaW4gPSB2YWw7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKG1heCA9PT0gSW5maW5pdHkpIHsKICAgICAgICAgICAgbWF4ID0gdmFsOwogICAgICAgICAgICAvLyB1cGRhdGUgbWluIG1heAogICAgICAgICAgICAvLyAxLiBQaWNrIDIgZWxlbWVudHMoYSwgYiksIGNvbXBhcmUgdGhlbS4gKHNheSBhID4gYikKICAgICAgICAgICAgbWluID0gTWF0aC5taW4obWluLCBtYXgpOwogICAgICAgICAgICBtYXggPSBNYXRoLm1heChtaW4sIG1heCk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAvLyAyLiBVcGRhdGUgbWluIGJ5IGNvbXBhcmluZyAobWluLCBiKQogICAgICAgICAgICAvLyAzLiBVcGRhdGUgbWF4IGJ5IGNvbXBhcmluZyAobWF4LCBhKQogICAgICAgICAgICBtaW4gPSBNYXRoLm1pbih2YWwsIG1pbik7CiAgICAgICAgICAgIG1heCA9IE1hdGgubWF4KHZhbCwgbWF4KTsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gW21pbiwgbWF4XTsKfQoKdmFyIGN0eCA9IHNlbGY7CmN0eC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZnVuY3Rpb24gKF9hKSB7CiAgICB2YXIgcGF5bG9hZCA9IF9hLmRhdGE7CiAgICByZXR1cm4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgcmVuZGVyRm9ybSwgdURhdGEsIHZEYXRhLCBfYiwgdU1pbiwgdU1heCwgX2MsIHZNaW4sIHZNYXgsIHZlbG9jaXR5RGF0YSwgaSwgciwgZywgc2luZ2xlRGF0YSwgX2QsIG1pbiwgbWF4LCB2ZWxvY2l0eURhdGEsIGksIHI7CiAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfZSkgewogICAgICAgICAgICByZW5kZXJGb3JtID0gcGF5bG9hZFswXTsKICAgICAgICAgICAgaWYgKHJlbmRlckZvcm0gPT09ICdyZycpIHsKICAgICAgICAgICAgICAgIHVEYXRhID0gcGF5bG9hZFsxXTsKICAgICAgICAgICAgICAgIHZEYXRhID0gcGF5bG9hZFsyXTsKICAgICAgICAgICAgICAgIF9iID0gY2FsY01pbk1heCh1RGF0YSksIHVNaW4gPSBfYlswXSwgdU1heCA9IF9iWzFdOwogICAgICAgICAgICAgICAgX2MgPSBjYWxjTWluTWF4KHZEYXRhKSwgdk1pbiA9IF9jWzBdLCB2TWF4ID0gX2NbMV07CiAgICAgICAgICAgICAgICB2ZWxvY2l0eURhdGEgPSBuZXcgVWludDhBcnJheSh1RGF0YS5sZW5ndGggKiA0KTsKICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB1RGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIHIgPSAyNTUgKiAodURhdGFbaV0gLSB1TWluKSAvICh1TWF4IC0gdU1pbik7CiAgICAgICAgICAgICAgICAgICAgZyA9IDI1NSAqICh2RGF0YVtpXSAtIHZNaW4pIC8gKHZNYXggLSB2TWluKTsKICAgICAgICAgICAgICAgICAgICB2ZWxvY2l0eURhdGEuc2V0KFtyLCBnLCAwLCAyNTVdLCBpICogNCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjdHgucG9zdE1lc3NhZ2UoW3ZlbG9jaXR5RGF0YS5idWZmZXIsIHVNaW4sIHVNYXgsIHZNaW4sIHZNYXhdLCBbdmVsb2NpdHlEYXRhLmJ1ZmZlcl0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgc2luZ2xlRGF0YSA9IHBheWxvYWRbMV07CiAgICAgICAgICAgICAgICBfZCA9IGNhbGNNaW5NYXgoc2luZ2xlRGF0YSksIG1pbiA9IF9kWzBdLCBtYXggPSBfZFsxXTsKICAgICAgICAgICAgICAgIHZlbG9jaXR5RGF0YSA9IG5ldyBVaW50OEFycmF5KHNpbmdsZURhdGEubGVuZ3RoICogNCk7CiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2luZ2xlRGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIHIgPSAyNTUgKiAoc2luZ2xlRGF0YVtpXSAtIG1pbikgLyAobWF4IC0gbWluKTsKICAgICAgICAgICAgICAgICAgICB2ZWxvY2l0eURhdGEuc2V0KFtyLCAwLCAwLCAyNTVdLCBpICogNCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjdHgucG9zdE1lc3NhZ2UoW3ZlbG9jaXR5RGF0YS5idWZmZXIsIG1pbiwgbWF4XSwgW3ZlbG9jaXR5RGF0YS5idWZmZXJdKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107CiAgICAgICAgfSk7CiAgICB9KTsKfSk7Cgo=",dr="data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGF0YVByb2Nlc3NlLmpzIiwic291cmNlcyI6WyIuLi8uLi9ub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2LmpzIiwic3JjL3V0aWxzL2NvbW1vbi50cyIsInNyYy93b3JrZXJzL0RhdGFQcm9jZXNzZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMCAmJiBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwocywgcFtpXSkpXHJcbiAgICAgICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgICAgICB9XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5cygpIHtcclxuICAgIGZvciAodmFyIHMgPSAwLCBpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgcyArPSBhcmd1bWVudHNbaV0ubGVuZ3RoO1xyXG4gICAgZm9yICh2YXIgciA9IEFycmF5KHMpLCBrID0gMCwgaSA9IDA7IGkgPCBpbDsgaSsrKVxyXG4gICAgICAgIGZvciAodmFyIGEgPSBhcmd1bWVudHNbaV0sIGogPSAwLCBqbCA9IGEubGVuZ3RoOyBqIDwgamw7IGorKywgaysrKVxyXG4gICAgICAgICAgICByW2tdID0gYVtqXTtcclxuICAgIHJldHVybiByO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCJleHBvcnQgZnVuY3Rpb24gY2FsY01pbk1heChhcnJheTogbnVtYmVyW10pOiBbbnVtYmVyLCBudW1iZXJdIHtcbiAgbGV0IG1pbiA9IEluZmluaXR5O1xuICBsZXQgbWF4ID0gSW5maW5pdHk7XG4gIC8vIEBmcm9tOiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMzU0NDQ3Ni9ob3ctdG8tZmluZC1tYXgtYW5kLW1pbi1pbi1hcnJheS11c2luZy1taW5pbXVtLWNvbXBhcmlzb25zXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCB2YWwgPSBhcnJheVtpXTtcblxuICAgIGlmIChtaW4gPT09IEluZmluaXR5KSB7XG4gICAgICBtaW4gPSB2YWw7XG4gICAgfSBlbHNlIGlmIChtYXggPT09IEluZmluaXR5KSB7XG4gICAgICBtYXggPSB2YWw7XG4gICAgICAvLyB1cGRhdGUgbWluIG1heFxuICAgICAgLy8gMS4gUGljayAyIGVsZW1lbnRzKGEsIGIpLCBjb21wYXJlIHRoZW0uIChzYXkgYSA+IGIpXG4gICAgICBtaW4gPSBNYXRoLm1pbihtaW4sIG1heCk7XG4gICAgICBtYXggPSBNYXRoLm1heChtaW4sIG1heCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIDIuIFVwZGF0ZSBtaW4gYnkgY29tcGFyaW5nIChtaW4sIGIpXG4gICAgICAvLyAzLiBVcGRhdGUgbWF4IGJ5IGNvbXBhcmluZyAobWF4LCBhKVxuICAgICAgbWluID0gTWF0aC5taW4odmFsLCBtaW4pO1xuICAgICAgbWF4ID0gTWF0aC5tYXgodmFsLCBtYXgpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gW21pbiwgbWF4XTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTnVtYmVyKHZhbDogYW55KTogYm9vbGVhbiB7XG4gIHJldHVybiB0eXBlb2YgdmFsID09PSAnbnVtYmVyJyAmJiAhaXNOYU4odmFsKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRlKHZhbDogYW55KTogYm9vbGVhbiB7XG4gIHJldHVybiB2YWwgIT09IHVuZGVmaW5lZCAmJiB2YWwgIT09IG51bGwgJiYgIWlzTmFOKHZhbCk7XG59XG4iLCJpbXBvcnQgeyBjYWxjTWluTWF4IH0gZnJvbSAnLi4vdXRpbHMvY29tbW9uJztcblxuY29uc3QgY3R4OiBXb3JrZXIgPSBzZWxmIGFzIGFueTtcblxuY3R4LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBhc3luYyAoeyBkYXRhOiBwYXlsb2FkIH0pID0+IHtcbiAgY29uc3QgcmVuZGVyRm9ybSA9IHBheWxvYWRbMF07XG4gIGlmIChyZW5kZXJGb3JtID09PSAncmcnKSB7XG4gICAgY29uc3QgdURhdGEgPSBwYXlsb2FkWzFdO1xuICAgIGNvbnN0IHZEYXRhID0gcGF5bG9hZFsyXTtcbiAgICBjb25zdCBbdU1pbiwgdU1heF0gPSBjYWxjTWluTWF4KHVEYXRhKTtcbiAgICBjb25zdCBbdk1pbiwgdk1heF0gPSBjYWxjTWluTWF4KHZEYXRhKTtcbiAgICBjb25zdCB2ZWxvY2l0eURhdGEgPSBuZXcgVWludDhBcnJheSh1RGF0YS5sZW5ndGggKiA0KTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHVEYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCByID0gMjU1ICogKHVEYXRhW2ldIC0gdU1pbikgLyAodU1heCAtIHVNaW4pO1xuICAgICAgY29uc3QgZyA9IDI1NSAqICh2RGF0YVtpXSAtIHZNaW4pIC8gKHZNYXggLSB2TWluKTtcbiAgICAgIHZlbG9jaXR5RGF0YS5zZXQoW3IsIGcsIDAsIDI1NV0sIGkgKiA0KTtcbiAgICB9XG5cbiAgICBjdHgucG9zdE1lc3NhZ2UoW3ZlbG9jaXR5RGF0YS5idWZmZXIsIHVNaW4sIHVNYXgsIHZNaW4sIHZNYXhdLCBbdmVsb2NpdHlEYXRhLmJ1ZmZlcl0pO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHNpbmdsZURhdGEgPSBwYXlsb2FkWzFdO1xuICAgIGNvbnN0IFttaW4sIG1heF0gPSBjYWxjTWluTWF4KHNpbmdsZURhdGEpO1xuICAgIGNvbnN0IHZlbG9jaXR5RGF0YSA9IG5ldyBVaW50OEFycmF5KHNpbmdsZURhdGEubGVuZ3RoICogNCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaW5nbGVEYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCByID0gMjU1ICogKHNpbmdsZURhdGFbaV0gLSBtaW4pIC8gKG1heCAtIG1pbik7XG4gICAgICB2ZWxvY2l0eURhdGEuc2V0KFtyLCAwLCAwLCAyNTVdLCBpICogNCk7XG4gICAgfVxuXG4gICAgY3R4LnBvc3RNZXNzYWdlKFt2ZWxvY2l0eURhdGEuYnVmZmVyLCBtaW4sIG1heF0sIFt2ZWxvY2l0eURhdGEuYnVmZmVyXSk7XG4gIH1cbn0pO1xuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7OztBQWNBLEFBb0RBO0FBQ0EsQUFBTyxTQUFTLFNBQVMsQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLENBQUMsRUFBRSxTQUFTLEVBQUU7SUFDekQsT0FBTyxLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsT0FBTyxDQUFDLEVBQUUsVUFBVSxPQUFPLEVBQUUsTUFBTSxFQUFFO1FBQ3ZELFNBQVMsU0FBUyxDQUFDLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7UUFDM0YsU0FBUyxRQUFRLENBQUMsS0FBSyxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFO1FBQzlGLFNBQVMsSUFBSSxDQUFDLE1BQU0sRUFBRSxFQUFFLE1BQU0sQ0FBQyxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxVQUFVLE9BQU8sRUFBRSxFQUFFLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxRQUFRLENBQUMsQ0FBQyxFQUFFO1FBQy9JLElBQUksQ0FBQyxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxVQUFVLElBQUksRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztLQUN6RSxDQUFDLENBQUM7Q0FDTjs7QUFFRCxBQUFPLFNBQVMsV0FBVyxDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUU7SUFDdkMsSUFBSSxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUNqSCxPQUFPLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxRQUFRLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsT0FBTyxNQUFNLEtBQUssVUFBVSxLQUFLLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsV0FBVyxFQUFFLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUN6SixTQUFTLElBQUksQ0FBQyxDQUFDLEVBQUUsRUFBRSxPQUFPLFVBQVUsQ0FBQyxFQUFFLEVBQUUsT0FBTyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRTtJQUNsRSxTQUFTLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZCxJQUFJLENBQUMsSUFBRSxNQUFNLElBQUksU0FBUyxDQUFDLGlDQUFpQyxDQUFDLEdBQUM7UUFDOUQsT0FBTyxDQUFDLElBQUUsSUFBSTtZQUNWLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxJQUFFLE9BQU8sQ0FBQyxHQUFDO1lBQzdKLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUUsRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUM7WUFDeEMsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUNULEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLE1BQU07Z0JBQzlCLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsQ0FBQztnQkFDeEQsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUztnQkFDakQsS0FBSyxDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsU0FBUztnQkFDakQ7b0JBQ0ksSUFBSSxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRTtvQkFDNUcsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRTtvQkFDdEYsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsTUFBTSxFQUFFO29CQUNyRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUU7b0JBQ25FLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLEdBQUM7b0JBQ3RCLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxTQUFTO2FBQzlCO1lBQ0QsRUFBRSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxDQUFDO1NBQzlCLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBRSxFQUFFLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsU0FBUyxFQUFFLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUU7UUFDMUQsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFDLENBQUMsT0FBTyxFQUFFLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLEtBQUssQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQztLQUNwRjtDQUNKOztTQ3RHZSxVQUFVLENBQUMsS0FBZTtJQUN4QyxJQUFJLEdBQUcsR0FBRyxRQUFRLENBQUM7SUFDbkIsSUFBSSxHQUFHLEdBQUcsUUFBUSxDQUFDOztJQUVuQixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtRQUNyQyxJQUFNLEdBQUcsR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFckIsSUFBSSxHQUFHLEtBQUssUUFBUSxFQUFFO1lBQ3BCLEdBQUcsR0FBRyxHQUFHLENBQUM7U0FDWDthQUFNLElBQUksR0FBRyxLQUFLLFFBQVEsRUFBRTtZQUMzQixHQUFHLEdBQUcsR0FBRyxDQUFDOzs7WUFHVixHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7WUFDekIsR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1NBQzFCO2FBQU07OztZQUdMLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQztZQUN6QixHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7U0FDMUI7S0FDRjtJQUNELE9BQU8sQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7Q0FDbkI7O0FDckJELElBQU0sR0FBRyxHQUFXLElBQVcsQ0FBQztBQUVoQyxHQUFHLENBQUMsZ0JBQWdCLENBQUMsU0FBUyxFQUFFLFVBQU8sRUFBaUI7UUFBZixpQkFBYTs7OztZQUM5QyxVQUFVLEdBQUcsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzlCLElBQUksVUFBVSxLQUFLLElBQUksRUFBRTtnQkFDakIsS0FBSyxHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDbkIsS0FBSyxHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDbkIsS0FBZSxVQUFVLENBQUMsS0FBSyxDQUFDLEVBQS9CLElBQUksUUFBQSxFQUFFLElBQUksUUFBQSxDQUFzQjtnQkFDakMsS0FBZSxVQUFVLENBQUMsS0FBSyxDQUFDLEVBQS9CLElBQUksUUFBQSxFQUFFLElBQUksUUFBQSxDQUFzQjtnQkFDakMsWUFBWSxHQUFHLElBQUksVUFBVSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7Z0JBQ3RELEtBQVMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtvQkFDL0IsQ0FBQyxHQUFHLEdBQUcsSUFBSSxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxDQUFDO29CQUM1QyxDQUFDLEdBQUcsR0FBRyxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxJQUFJLEdBQUcsSUFBSSxDQUFDLENBQUM7b0JBQ2xELFlBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7aUJBQ3pDO2dCQUVELEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7YUFDdkY7aUJBQU07Z0JBQ0MsVUFBVSxHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDeEIsS0FBYSxVQUFVLENBQUMsVUFBVSxDQUFDLEVBQWxDLEdBQUcsUUFBQSxFQUFFLEdBQUcsUUFBQSxDQUEyQjtnQkFDcEMsWUFBWSxHQUFHLElBQUksVUFBVSxDQUFDLFVBQVUsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7Z0JBQzNELEtBQVMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsVUFBVSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtvQkFDcEMsQ0FBQyxHQUFHLEdBQUcsSUFBSSxVQUFVLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLElBQUksR0FBRyxHQUFHLEdBQUcsQ0FBQyxDQUFDO29CQUNwRCxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO2lCQUN6QztnQkFFRCxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsWUFBWSxDQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDLEVBQUUsQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQzthQUN6RTs7OztDQUNGLENBQUMsQ0FBQyJ9",yr=!1,pr?hr(fr,dr,yr):function(t,e,r){var n;return function(i){return n=n||gr(t,e,r),new Worker(n,i)}}(fr,dr,yr));var Br=function(){function t(t,e){if(void 0===e&&(e={}),this.gl=t,!this.gl)throw new Error("initialize error");this.styleSpec={"fill-color":{type:"color",default:["interpolate",["linear"],["get","value"],0,"#3288bd",10,"#66c2a5",20,"#abdda4",30,"#e6f598",40,"#fee08b",50,"#fdae61",60,"#f46d43",100,"#d53e4f"],doc:"The color of each pixel of this layer",expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},opacity:{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},this.zoomUpdatable={},this.options=e,this.opacity=this.options.opacity||1}return t.prototype.updateOptions=function(t){var e=this;void 0===t&&(t={}),this.options=Object.assign({},this.options,t),Object.keys(this.styleSpec).forEach((function(t){e.setProperty(t,e.options.styleSpec[t]||e.styleSpec[t].default)}))},t.prototype.setProperty=function(t,e){var r=this.styleSpec[t];if(r){var n=je.createPropertyExpression(e,r);if("success"!==n.result)throw new Error(n.value);switch(n.value.kind){case"camera":case"composite":return this.zoomUpdatable[t]=n.value;default:return this.setPropertyValue(t,n.value)}}},t.prototype.setPropertyValue=function(t,e){var r=t.split("-").map((function(t){return t[0].toUpperCase()+t.slice(1)})).join(""),n="set"+r;this[n]?this[n](e):"function"==typeof this.options.getZoom&&(this[r[0].toLowerCase()+r.slice(1)]=e.evaluate({zoom:this.options.getZoom()}))},t.prototype.setFillColor=function(t){this.buildColorRamp(t)},t.prototype.handleZoom=function(){var t=this;Object.entries(this.zoomUpdatable).forEach((function(e){var r=e[0],n=e[1];t.setPropertyValue(r,n)}))},t.prototype.buildColorRamp=function(t){var e,r=new Uint8Array(1024),n=1;if("source"===t.kind||"composite"===t.kind)if("rg"===this.options.renderForm&&(ur((e=this.data).uMin)&&ur(e.uMax)&&ur(e.vMin)&&ur(e.vMax))){var i=this.data.uMax-this.data.uMin,o=this.data.vMax-this.data.vMin;n=Math.sqrt(i*i+o*o)}else"r"===this.options.renderForm&&function(t){return ur(t.min)&&ur(t.max)}(this.data)?n=this.data.max-this.data.min:console.warn("This type is not supported temporarily");for(var a=0;a<256;a++){var s="constant"===t.kind||"source"===t.kind?{}:"function"==typeof this.options.getZoom?{zoom:this.options.getZoom()}:{},u=t.evaluate(s,{properties:{value:a/255*n}});r[4*a+0]=255*u.r,r[4*a+1]=255*u.g,r[4*a+2]=255*u.b,r[4*a+3]=255*u.a}this.colorRampTexture=$e(this.gl,this.gl.LINEAR,r,16,16)},t.prototype.initialize=function(t){var e=this;"rg"===this.options.renderForm?this.drawCommand=new ir(t):"r"===this.options.renderForm?this.drawCommand=new sr(t):console.warn("This type is not supported temporarily"),Object.keys(this.styleSpec).forEach((function(t){e.setProperty(t,e.options.styleSpec[t]||e.styleSpec[t].default)}))},t.prototype.getTextureData=function(t){var e=this;return new Promise((function(r,n){if("image"===t.type&&t.url)(g=t.url,new Promise((function(t,e){g||e(new Event("url is null"));var r=new Image;r.crossOrigin="anonymous",r.onload=function(){return t(r)},r.onerror=e,r.src=g,r.complete&&t(r)}))).then((function(n){var i=Q(e.getMercatorCoordinate(t.extent[0]),e.getMercatorCoordinate(t.extent[1]),e.getMercatorCoordinate(t.extent[2]),e.getMercatorCoordinate(t.extent[2]),e.getMercatorCoordinate(t.extent[1]),e.getMercatorCoordinate(t.extent[3])),o={width:n.width,height:n.height,quadBuffer:tr(e.gl,new Float32Array(i)),texCoordBuffer:tr(e.gl,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1])),texture:$e(e.gl,e.gl.LINEAR,n,n.width,n.height)};"rg"===e.options.renderForm?(o.uMin=t.uMin,o.uMax=t.uMax,o.vMin=t.vMin,o.vMax=t.vMax):"r"===e.options.renderForm?(o.min=t.min,o.max=t.max):console.warn("This type is not supported temporarily"),r(o)})).catch((function(t){return n(t)}));else if("jsonArray"===t.type&&t.data){var i=t.data,o=void 0;o=t.extent?Q(e.getMercatorCoordinate(t.extent[0]),e.getMercatorCoordinate(t.extent[1]),e.getMercatorCoordinate(t.extent[2]),e.getMercatorCoordinate(t.extent[2]),e.getMercatorCoordinate(t.extent[1]),e.getMercatorCoordinate(t.extent[3])):Q(e.getMercatorCoordinate([i[0].header.lo1,i[0].header.la1]),e.getMercatorCoordinate([i[0].header.lo1,i[0].header.la2]),e.getMercatorCoordinate([i[0].header.lo2,i[0].header.la1]),e.getMercatorCoordinate([i[0].header.lo2,i[0].header.la1]),e.getMercatorCoordinate([i[0].header.lo1,i[0].header.la2]),e.getMercatorCoordinate([i[0].header.lo2,i[0].header.la2]));var a={width:i[0].header.nx,height:i[0].header.ny,quadBuffer:tr(e.gl,new Float32Array(o)),texCoordBuffer:tr(e.gl,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]))};if(e.worker||(e.worker=new Ir,e.worker.addEventListener("message",(function(t){var n=t.data;"rg"===e.options.renderForm?(a.uMin=n[1],a.uMax=n[2],a.vMin=n[3],a.vMax=n[4],a.texture=$e(e.gl,e.gl.LINEAR,new Uint8Array(n[0]),a.width,a.height)):"r"===e.options.renderForm?(a.min=n[1],a.max=n[2],a.texture=$e(e.gl,e.gl.LINEAR,new Uint8Array(n[0]),a.width,a.height)):console.warn("This type is not supported temporarily"),r(a)}))),"rg"===e.options.renderForm){var s,u;i.forEach((function(t){switch(t.header.parameterCategory+","+t.header.parameterNumber){case"1,2":case"2,2":s=t;break;case"1,3":case"2,3":u=t}}));var l=new Float32Array(s.data),c=new Float32Array(u.data);e.worker.postMessage(["rg",l,c])}else if("r"===e.options.renderForm){var h=new Float32Array(i[0].data);e.worker.postMessage(["r",h])}else console.warn("This type is not supported temporarily")}var g}))},t.prototype.setData=function(t){var e=this;this.gl&&this.getTextureData(t).then((function(t){e.data=t,e.data&&e.initialize(e.gl),e.options.triggerRepaint&&(e.handleZoom(),e.options.triggerRepaint())})).catch((function(t){console.error(t)}))},t.prototype.getData=function(){return this.data},t.prototype.getMercatorCoordinate=function(t){return[t[0],t[1]]},t.prototype.prerender=function(){},t.prototype.render=function(t,e){if(this.data&&this.drawCommand&&this.data.texture&&this.colorRampTexture){var r=this.opacity,n={u_opacity:ur(r)?r:1,u_image_res:[this.data.width,this.data.height],u_matrix:t,u_dateline_offset:ur(e)?e:0,u_color_ramp:this.colorRampTexture};"rg"===this.options.renderForm?(n.u_wind_min=[this.data.uMin,this.data.vMin],n.u_wind_max=[this.data.uMax,this.data.vMax],n.u_wind=this.data.texture):"r"===this.options.renderForm?(n.u_range=[this.data.min,this.data.max],n.u_image=this.data.texture):console.warn("This type is not supported temporarily"),this.drawCommand.active().setUniforms(n).setAttributes({a_position:{buffer:this.data.quadBuffer,numComponents:2},a_texCoord:{buffer:this.data.texCoordBuffer,numComponents:2}}).runTimes(6).draw()}},t.prototype.postrender=function(){},t}();function mr(t){var e=t[0],r=t[1],n=o.MercatorCoordinate.fromLngLat({lng:e,lat:r});return[n.x,n.y]}var vr=function(){function t(t,e,r){void 0===r&&(r={}),this.id=t,this.type="custom",this.renderingMode="2d",this.options=r,this.data=e,this.handleZoom=this.handleZoom.bind(this)}return t.prototype.handleZoom=function(){this.scalarFill&&this.scalarFill.handleZoom()},t.prototype.initialize=function(){var t=this;!this.scalarFill&&this.gl&&(this.scalarFill=new Br(this.gl,{opacity:this.options.opacity,renderForm:this.options.renderForm,styleSpec:this.options.styleSpec,getZoom:function(){return t.map.getZoom()},triggerRepaint:function(){t.map.triggerRepaint()}}),this.scalarFill.getMercatorCoordinate=mr,this.map.on("zoom",this.handleZoom)),this.scalarFill.setData(this.data)},t.prototype.onAdd=function(t,e){this.gl=e,this.map=t,this.map&&this.initialize()},t.prototype.setData=function(t){this.data=t,this.map&&this.initialize()},t.prototype.onRemove=function(t){delete this.gl,delete this.map,t.off("zoom",this.handleZoom)},t.prototype.render=function(t,e){if(this.data&&this.scalarFill){var r=this.map.getBounds(),n=Math.max(0,Math.ceil((r.getEast()-180)/360)),i=Math.max(0,Math.ceil((r.getWest()+180)/-360));this.scalarFill.render(e,0);for(var o=1;o<=n;o++)this.scalarFill.render(e,o);for(o=1;o<=i;o++)this.scalarFill.render(e,-o)}},t}(),Fr={doubleBuffer:!1,windOptions:y},br=function(t){function e(e,r,n){void 0===n&&(n={});var i=t.call(this,e,Object.assign({},Fr,n))||this;return i.field=null,i.pickWindOptions(),r&&i.setData(r),i.stop=i.stop.bind(i),i.render=i.render.bind(i),i}return function(t,e){function r(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype.onAdd=function(e){if(t.prototype.onAdd.call(this,e),!this.map)throw new Error("map is null");null!==this.canvas&&(this.render(),this.registerEvents())},e.prototype.registerEvents=function(){this.map.on("resize",this.render),this.map.on("movestart",this.stop),this.map.on("moveend",this.render),this.map.on("zoomstart",this.stop),this.map.on("zoomend",this.render),this.map.on("rotatestart",this.stop),this.map.on("rotateend",this.render),this.map.on("pitchstart",this.stop),this.map.on("pitchend",this.render)},e.prototype.unregisterEvents=function(){this.map.off("resize",this.render),this.map.off("movestart",this.stop),this.map.off("moveend",this.render),this.map.off("zoomstart",this.stop),this.map.off("zoomend",this.render),this.map.off("rotatestart",this.stop),this.map.off("rotateend",this.render),this.map.off("pitchstart",this.stop),this.map.off("pitchend",this.render)},e.prototype.stop=function(){this.wind&&this.wind.clearCanvas()},e.prototype.render=function(){if(this.map){var t=this.getWindOptions();if(!this.wind&&this.map&&null!==this.canvas){var e=this.canvas.getContext("2d");if(!e)return void console.error("create canvas context failed");var r=this.getData();this.wind=new B(e,t,r),this.wind.project=this.project.bind(this),this.wind.unproject=this.unproject.bind(this),this.wind.intersectsCoordinate=this.intersectsCoordinate.bind(this),this.wind.postrender=function(){}}this.wind.prerender(),this.wind.render()}},e.prototype.remove=function(){t.prototype.remove.call(this),this.wind&&this.wind.stop(),this.unregisterEvents()},e.prototype.pickWindOptions=function(){var t=this;Object.keys(y).forEach((function(e){e in t.options&&(void 0===t.options.windOptions&&(t.options.windOptions={}),t.options.windOptions[e]=t.options[e])}))},e.prototype.getData=function(){return this.field},e.prototype.setData=function(t){var e;return t&&t.checkFields&&t.checkFields()?this.field=t:(e=t,Array.isArray(e)?this.field=function(t){var e,r;if(console.time("format-data"),t.forEach((function(t){switch(t.header.parameterCategory+","+t.header.parameterNumber){case"1,2":case"2,2":e=t;break;case"1,3":case"2,3":r=t}})),r&&e){var n=e.header,i=new d({xmin:n.lo1,ymin:n.la2,xmax:n.lo2,ymax:n.la1,deltaX:n.dx,deltaY:n.dy,cols:n.nx,rows:n.ny,us:e.data,vs:r.data});return console.timeEnd("format-data"),i}}(t):console.error("Illegal data")),this},e.prototype.setWindOptions=function(t){var e=this.options.windOptions||{};if(this.options=g(this.options,{windOptions:g(e,t||{})}),this.wind){var r=this.options.windOptions;this.wind.setOptions(r),this.wind.prerender()}},e.prototype.getWindOptions=function(){return this.options.windOptions||{}},e}(v);e.default=br}.call(this,r(233)(t),r(234).Buffer)}}]);